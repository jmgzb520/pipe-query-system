<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šå“ç‰Œå¤šè”æœºç®¡å¾„æŸ¥è¯¢ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        /* è‡ªå®šä¹‰æ¸å˜èƒŒæ™¯ */
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-gradient {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 py-8 px-4">
    <!-- ç™»å½•æç¤ºå®¹å™¨ï¼ˆæœªç™»å½•æ—¶æ˜¾ç¤ºï¼‰ -->
    <div id="loginWelcome" class="min-h-screen flex items-center justify-center">
        <div class="max-w-md w-full mx-4 text-center">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <div class="mb-6">
                    <div class="text-6xl mb-4">ğŸ”’</div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">å¤šå“ç‰Œå¤šè”æœºç®¡å¾„æŸ¥è¯¢ç³»ç»Ÿ</h1>
                    <p class="text-gray-600">è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨ç®¡å¾„æŸ¥è¯¢åŠŸèƒ½</p>
                </div>
                <button onclick="document.getElementById('loginBtn').click()" class="w-full px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition font-medium">
                    ç«‹å³ç™»å½•
                </button>
            </div>
        </div>
    </div>

    <!-- ä¸»é¡µé¢å®¹å™¨ï¼ˆç™»å½•åæ˜¾ç¤ºï¼‰ -->
    <div id="mainContent" class="hidden max-w-6xl mx-auto">
        <!-- æ ‡é¢˜åŒºåŸŸ -->
        <div class="text-center mb-6 relative">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">
                å¤šè”æœºå†…æœºç®¡å¾„æŸ¥è¯¢
            </h1>
            <p class="text-gray-600">
                å¿«é€ŸæŸ¥è¯¢å„å“ç‰Œç©ºè°ƒå‹å·çš„ç®¡å¾„è§„æ ¼ä¿¡æ¯
            </p>
            <button id="loginBtn" class="absolute right-0 top-0 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                ç™»å½•
            </button>
            <button id="logoutBtn" class="hidden absolute right-0 top-0 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition">
                ç™»å‡º
            </button>
        </div>

        <!-- æ ‡ç­¾é¡µ -->
        <div class="bg-white rounded-lg shadow mb-6">
            <div class="flex border-b">
                <button id="tabMulti" class="flex-1 py-3 px-4 text-center font-medium border-b-2 border-blue-500 text-blue-600 bg-blue-50">
                    å¤šè”æœºå†…æœº
                </button>
                <button id="tabDownstream" class="flex-1 py-3 px-4 text-center font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-800">
                    å¤šè”æœºä¸‹æ¸¸ç®¡å¾„
                </button>
                <button id="tabOneToOne" class="flex-1 py-3 px-4 text-center font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-800">
                    ä¸€æ‹–ä¸€
                </button>
            </div>
        </div>

        <!-- å¤šè”æœºå†…æœºé¡µé¢ -->
        <div id="multiPage">

        <!-- æŸ¥è¯¢è¡¨å• -->
        <div class="bg-white rounded-lg shadow p-6 mb-6 relative">
            <div class="absolute -top-3 -left-3 bg-blue-600 text-white text-xs px-3 py-1 rounded-md shadow-md font-bold tracking-wide">
                å›½æ–°æœºç”µgzb
            </div>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        é€‰æ‹©å“ç‰Œ
                    </label>
                    <select id="brandSelect" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">è¯·é€‰æ‹©å“ç‰Œ</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        é€‰æ‹©å†·é‡ (kW)
                    </label>
                    <select id="modelSelect" disabled class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed">
                        <option value="">è¯·é€‰æ‹©å†·é‡</option>
                    </select>
                </div>
            </div>

            <!-- ç™»å½•æç¤º -->
            <div id="loginTip1" class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md hidden">
                <div class="flex items-center gap-3">
                    <span class="text-2xl">ğŸ”’</span>
                    <div>
                        <p class="text-sm font-medium text-yellow-800">è¯·å…ˆç™»å½•</p>
                        <p class="text-xs text-yellow-600 mt-1">ç™»å½•åå³å¯ä½¿ç”¨æŸ¥è¯¢åŠŸèƒ½</p>
                    </div>
                    <button onclick="document.getElementById('loginBtn').click()" class="ml-auto px-4 py-2 bg-yellow-600 text-white text-sm rounded-md hover:bg-yellow-700 transition">
                        ç«‹å³ç™»å½•
                    </button>
                </div>
            </div>
        </div>

        <!-- æŸ¥è¯¢ç»“æœ -->
        <div id="resultContainer" class="hidden">
            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-3xl">ğŸ“</span>
                    ç®¡å¾„è§„æ ¼ä¿¡æ¯
                </h2>
                <div class="grid md:grid-cols-2 gap-4" id="pipeSpecs">
                </div>
                <!-- è®¾å¤‡é€‰å‹è¯´æ˜ -->
                <div class="mt-6 pt-6 border-t border-gray-200">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <p class="text-sm font-medium text-gray-700">é€‰å‹è®¾å¤‡</p>
                            <p class="text-sm text-gray-500" id="deviceInfo">æš‚æ— è®¾å¤‡ä¿¡æ¯</p>
                        </div>
                        <div class="space-y-2">
                            <p class="text-sm font-medium text-gray-700">é€‰æ‹©å†·é‡</p>
                            <p class="text-sm text-gray-500" id="capacityInfo">æš‚æ— å†·é‡ä¿¡æ¯</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ— æ•°æ®æç¤º -->
        <div id="noDataMessage" class="hidden bg-white rounded-lg shadow p-12 text-center">
            <p class="text-gray-500">æš‚æ— ç®¡å¾„è§„æ ¼æ•°æ®</p>
        </div>

        <!-- ç®¡ç†åŠŸèƒ½æŒ‰é’®ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰ -->
        <div id="adminButtonsMulti" class="hidden mt-6">
            <div class="bg-white rounded-lg shadow p-4">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">æ•°æ®ç®¡ç†</h3>
                <div class="flex gap-4">
                    <button id="exportMultiBtn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                        ğŸ“¤ å¯¼å‡ºæ•°æ®
                    </button>
                    <button id="importMultiBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                        ğŸ“¥ å¯¼å…¥æ•°æ®
                    </button>
                </div>
            </div>
        </div>
        </div>

        <!-- å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ -->
        <div id="downstreamPage" class="hidden">
            <!-- æŸ¥è¯¢è¡¨å• -->
            <div class="bg-white rounded-lg shadow p-6 mb-6 relative">
                <div class="absolute -top-3 -left-3 bg-purple-600 text-white text-xs px-3 py-1 rounded-md shadow-md font-bold tracking-wide">
                    å›½æ–°æœºç”µgzb
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            é€‰æ‹©å“ç‰Œ
                        </label>
                        <select id="brandSelect3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                            <option value="">è¯·é€‰æ‹©å“ç‰Œ</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            å†·é‡è®¡ç®—ç»“æœ (kW)
                        </label>
                        <input type="text" id="totalCapacity3" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-purple-50 text-purple-700 font-bold focus:outline-none" placeholder="è‡ªåŠ¨è®¡ç®—" value="0">
                    </div>
                </div>

                <!-- å®¤å†…æœºå†·é‡è¾“å…¥åŒºåŸŸ -->
                <div class="mt-6">
                    <div class="flex items-center justify-between mb-3">
                        <label class="text-sm font-medium text-gray-700">
                            å®¤å†…æœºå†·é‡è¾“å…¥ (kW)
                        </label>
                        <button id="clearAllBtn3" class="text-sm text-gray-500 hover:text-gray-700 transition">
                            æ¸…ç©ºæ‰€æœ‰
                        </button>
                    </div>
                    <!-- çº¢è‰²æ¡†å®¹å™¨ï¼šå›ºå®šé«˜åº¦ï¼Œå¯æ»šåŠ¨ -->
                    <div class="border-2 border-red-500 rounded-lg p-4 bg-red-50 overflow-y-auto" style="max-height: 200px;" id="indoorUnitsScrollContainer">
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3" id="indoorUnitsContainer">
                            <!-- å®¤å†…æœºè¾“å…¥æ¡†å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>

                <!-- ç™»å½•æç¤º -->
                <div id="loginTip3" class="mt-4 p-4 bg-purple-50 border border-purple-200 rounded-md hidden">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">ğŸ”’</span>
                        <div>
                            <p class="text-sm font-medium text-purple-800">è¯·å…ˆç™»å½•</p>
                            <p class="text-xs text-purple-600 mt-1">ç™»å½•åå³å¯ä½¿ç”¨æŸ¥è¯¢åŠŸèƒ½</p>
                        </div>
                        <button onclick="document.getElementById('loginBtn').click()" class="ml-auto px-4 py-2 bg-purple-600 text-white text-sm rounded-md hover:bg-purple-700 transition">
                            ç«‹å³ç™»å½•
                        </button>
                    </div>
                </div>
            </div>

            <!-- æŸ¥è¯¢ç»“æœ -->
            <div id="resultContainer3" class="hidden">
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                        <span class="text-3xl">ğŸ“</span>
                        ç®¡å¾„è§„æ ¼ä¿¡æ¯
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4" id="pipeSpecs3">
                    </div>
                    <!-- è®¾å¤‡é€‰å‹è¯´æ˜ -->
                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <p class="text-sm font-medium text-gray-700">é€‰å‹è®¾å¤‡</p>
                                <p class="text-sm text-gray-500" id="deviceInfo3">æš‚æ— è®¾å¤‡ä¿¡æ¯</p>
                            </div>
                            <div class="space-y-2">
                                <p class="text-sm font-medium text-gray-700">é€‰æ‹©å†·é‡</p>
                                <p class="text-sm text-gray-500" id="capacityInfo3">æš‚æ— å†·é‡ä¿¡æ¯</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ— æ•°æ®æç¤º -->
            <div id="noDataMessage3" class="hidden bg-white rounded-lg shadow p-12 text-center">
                <p class="text-gray-500">æš‚æ— ç®¡å¾„è§„æ ¼æ•°æ®</p>
            </div>

            <!-- ç®¡ç†åŠŸèƒ½æŒ‰é’®ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰ -->
            <div id="adminButtonsDownstream" class="hidden mt-6">
                <div class="bg-white rounded-lg shadow p-4">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">æ•°æ®ç®¡ç†</h3>
                    <div class="flex gap-4">
                        <button id="exportDownstreamBtn" class="px-4 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 transition">
                            ğŸ“¤ å¯¼å‡ºæ•°æ®
                        </button>
                        <button id="importDownstreamBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                            ğŸ“¥ å¯¼å…¥æ•°æ®
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸€æ‹–ä¸€é¡µé¢ -->
        <div id="oneToOnePage" class="hidden">
            <!-- æŸ¥è¯¢è¡¨å• -->
            <div class="bg-white rounded-lg shadow p-6 mb-6 relative">
                <div class="absolute -top-3 -left-3 bg-green-600 text-white text-xs px-3 py-1 rounded-md shadow-md font-bold tracking-wide">
                    å›½æ–°æœºç”µgzb
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            é€‰æ‹©å“ç‰Œ
                        </label>
                        <select id="brandSelect2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">è¯·é€‰æ‹©å“ç‰Œ</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            é€‰æ‹©å†·é‡ (kW)
                        </label>
                        <select id="modelSelect2" disabled class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed">
                            <option value="">è¯·é€‰æ‹©å†·é‡</option>
                        </select>
                    </div>
                </div>

                <!-- ç™»å½•æç¤º -->
                <div id="loginTip2" class="mt-4 p-4 bg-green-50 border border-green-200 rounded-md hidden">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">ğŸ”’</span>
                        <div>
                            <p class="text-sm font-medium text-green-800">è¯·å…ˆç™»å½•</p>
                            <p class="text-xs text-green-600 mt-1">ç™»å½•åå³å¯ä½¿ç”¨æŸ¥è¯¢åŠŸèƒ½</p>
                        </div>
                        <button onclick="document.getElementById('loginBtn').click()" class="ml-auto px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition">
                            ç«‹å³ç™»å½•
                        </button>
                    </div>
                </div>
            </div>

            <!-- æŸ¥è¯¢ç»“æœ -->
            <div id="resultContainer2" class="hidden">
                <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                        <span class="text-3xl">ğŸ“</span>
                        ç®¡å¾„è§„æ ¼ä¿¡æ¯
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4" id="pipeSpecs2">
                    </div>
                    <!-- è®¾å¤‡é€‰å‹è¯´æ˜ -->
                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <p class="text-sm font-medium text-gray-700">é€‰å‹è®¾å¤‡</p>
                                <p class="text-sm text-gray-500" id="deviceInfo2">æš‚æ— è®¾å¤‡ä¿¡æ¯</p>
                            </div>
                            <div class="space-y-2">
                                <p class="text-sm font-medium text-gray-700">é€‰æ‹©å†·é‡</p>
                                <p class="text-sm text-gray-500" id="capacityInfo2">æš‚æ— å†·é‡ä¿¡æ¯</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ— æ•°æ®æç¤º -->
            <div id="noDataMessage2" class="hidden bg-white rounded-lg shadow p-12 text-center">
                <p class="text-gray-500">æš‚æ— ç®¡å¾„è§„æ ¼æ•°æ®</p>
            </div>

            <!-- ç®¡ç†åŠŸèƒ½æŒ‰é’®ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰ -->
            <div id="adminButtonsOneToOne" class="hidden mt-6">
                <div class="bg-white rounded-lg shadow p-4">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">æ•°æ®ç®¡ç†</h3>
                    <div class="flex gap-4">
                        <button id="exportOneToOneBtn" class="px-4 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700 transition">
                            ğŸ“¤ å¯¼å‡ºæ•°æ®
                        </button>
                        <button id="importOneToOneBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                            ğŸ“¥ å¯¼å…¥æ•°æ®
                        </button>
                    </div>
                </div>
            </div>
        </div>

        </div>

        <!-- ç™»å½•æ¨¡æ€æ¡† -->
        <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">ç”¨æˆ·ç™»å½•</h2>
                <p class="text-sm text-gray-600 mb-6">è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨ç®¡å¾„æŸ¥è¯¢åŠŸèƒ½</p>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç”¨æˆ·å</label>
                    <input type="text" id="username" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">å¯†ç </label>
                    <input type="password" id="password" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="è¯·è¾“å…¥å¯†ç ">
                </div>
                <div class="mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="rememberMe" checked class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                        <span class="ml-2 text-sm text-gray-700">è®°ä½ç™»å½•çŠ¶æ€</span>
                    </label>
                </div>
                <div>
                    <button id="loginSubmitBtn" class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                        ç™»å½•
                    </button>
                </div>
            </div>
        </div>

        <!-- å¤šè”æœºå†…æœºå¯¼å…¥æ¨¡æ€æ¡† -->
        <div id="importModalMulti" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">å¯¼å…¥å¤šè”æœºå†…æœºæ•°æ®</h2>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                    <p class="text-sm text-blue-800 font-medium mb-2">ğŸ’¡ Excelæ–‡ä»¶æ ¼å¼è¯´æ˜ï¼š</p>
                    <p class="text-xs text-blue-700">
                        æ¯ä¸ªå‹å·ä¸€è¡Œï¼Œåˆ—åï¼šå“ç‰Œã€è®¾å¤‡å†·é‡ã€æ°”ç®¡ã€æ¶²ç®¡
                    </p>
                    <p class="text-xs text-blue-700 mt-1">
                        ä¾‹å¦‚ï¼šæµ·ä¿¡/æ—¥ç«‹ | 1.5 | Î¦12.7 | Î¦6.3
                    </p>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">é€‰æ‹©Excelæ–‡ä»¶</label>
                    <input type="file" id="importMultiFile2" accept=".xlsx,.xls" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                </div>
                <div class="flex gap-4">
                    <button id="importMultiSubmitBtn" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                        å¼€å§‹å¯¼å…¥
                    </button>
                    <button id="importMultiCancelBtn" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition">
                        å–æ¶ˆ
                    </button>
                </div>
            </div>
        </div>

        <!-- ä¸€æ‹–ä¸€å¯¼å…¥æ¨¡æ€æ¡† -->
        <div id="importModalOneToOne" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">å¯¼å…¥ä¸€æ‹–ä¸€æ•°æ®</h2>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <p class="text-sm text-green-800 font-medium mb-2">ğŸ’¡ Excelæ–‡ä»¶æ ¼å¼è¯´æ˜ï¼š</p>
                    <p class="text-xs text-green-700">
                        æ¯ä¸ªå‹å·ä¸€è¡Œï¼Œåˆ—åï¼šå“ç‰Œã€è®¾å¤‡å†·é‡ã€æ°”ç®¡ã€æ¶²ç®¡
                    </p>
                    <p class="text-xs text-green-700 mt-1">
                        ä¾‹å¦‚ï¼šæµ·ä¿¡/æ—¥ç«‹ | 1.5 | Î¦9.5 | Î¦6.3
                    </p>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">é€‰æ‹©Excelæ–‡ä»¶</label>
                    <input type="file" id="importOneToOneFile2" accept=".xlsx,.xls" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                </div>
                <div class="flex gap-4">
                    <button id="importOneToOneSubmitBtn" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                        å¼€å§‹å¯¼å…¥
                    </button>
                    <button id="importOneToOneCancelBtn" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition">
                        å–æ¶ˆ
                    </button>
                </div>
            </div>
        </div>

        <!-- å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å¯¼å…¥æ¨¡æ€æ¡† -->
        <div id="importModalDownstream" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">å¯¼å…¥å¤šè”æœºä¸‹æ¸¸ç®¡å¾„æ•°æ®</h2>
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                    <p class="text-sm text-purple-800 font-medium mb-2">ğŸ’¡ Excelæ–‡ä»¶æ ¼å¼è¯´æ˜ï¼š</p>
                    <p class="text-xs text-purple-700">
                        æ¯ä¸ªå‹å·ä¸€è¡Œï¼Œåˆ—åï¼šå“ç‰Œã€è®¾å¤‡å†·é‡ã€æ°”ç®¡ã€æ¶²ç®¡ã€åˆ†æ­§ç®¡
                    </p>
                    <p class="text-xs text-purple-700 mt-1">
                        ä¾‹å¦‚ï¼šæµ·ä¿¡/æ—¥ç«‹ | Aâ‰¤16.8 | 15.9mm | 9.5mm | FQZHN-01C
                    </p>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">é€‰æ‹©Excelæ–‡ä»¶</label>
                    <input type="file" id="importDownstreamFile2" accept=".xlsx,.xls" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                </div>
                <div class="flex gap-4">
                    <button id="importDownstreamSubmitBtn" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition">
                        å¼€å§‹å¯¼å…¥
                    </button>
                    <button id="importDownstreamCancelBtn" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition">
                        å–æ¶ˆ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€é”™è¯¯æ•è·
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('å…¨å±€é”™è¯¯:', message, 'at', source, lineno, ':', colno);
            console.error('é”™è¯¯å¯¹è±¡:', error);
        };

        // ç­‰å¾…DOMåŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ– ===');

            // ============ æ•°æ®å­˜å‚¨ï¼ˆç§»åˆ°å‰é¢ä»¥ç¡®ä¿åœ¨ä½¿ç”¨å‰å·²å®šä¹‰ï¼‰============
            const brands = [
            { id: 1, name: "æµ·ä¿¡/æ—¥ç«‹" },
            { id: 2, name: "ç¾çš„" },
            { id: 3, name: "ä¸‰è±é‡å·¥" },
            { id: 4, name: "ä¸‰è±é‡å·¥æµ·å°”" },
            { id: 5, name: "æ ¼åŠ›" },
            { id: 6, name: "å¤§é‡‘" },
        ];

        const models = [
            { id: 1, brandId: 1, modelName: "1.5", capacity: "1.5 kW" },
            { id: 2, brandId: 1, modelName: "1.8", capacity: "1.8 kW" },
            { id: 3, brandId: 1, modelName: "2.2", capacity: "2.2 kW" },
            { id: 4, brandId: 1, modelName: "2.5", capacity: "2.5 kW" },
            { id: 5, brandId: 1, modelName: "2.8", capacity: "2.8 kW" },
            { id: 6, brandId: 1, modelName: "3.2", capacity: "3.2 kW" },
            { id: 7, brandId: 1, modelName: "3.6", capacity: "3.6 kW" },
            { id: 8, brandId: 1, modelName: "4", capacity: "4 kW" },
            { id: 9, brandId: 1, modelName: "4.5", capacity: "4.5 kW" },
            { id: 10, brandId: 1, modelName: "5", capacity: "5 kW" },
            { id: 11, brandId: 1, modelName: "5.6", capacity: "5.6 kW" },
            { id: 12, brandId: 1, modelName: "6.3", capacity: "6.3 kW" },
            { id: 13, brandId: 1, modelName: "7.1", capacity: "7.1 kW" },
            { id: 14, brandId: 1, modelName: "8", capacity: "8 kW" },
            { id: 15, brandId: 1, modelName: "9", capacity: "9 kW" },
            { id: 16, brandId: 1, modelName: "10", capacity: "10 kW" },
            { id: 17, brandId: 1, modelName: "11.2", capacity: "11.2 kW" },
            { id: 18, brandId: 1, modelName: "12.5", capacity: "12.5 kW" },
            { id: 19, brandId: 1, modelName: "14", capacity: "14 kW" },
            { id: 20, brandId: 1, modelName: "16", capacity: "16 kW" },
            { id: 21, brandId: 2, modelName: "1.5", capacity: "1.5 kW" },
            { id: 22, brandId: 2, modelName: "1.8", capacity: "1.8 kW" },
            { id: 23, brandId: 2, modelName: "2.2", capacity: "2.2 kW" },
            { id: 24, brandId: 2, modelName: "2.5", capacity: "2.5 kW" },
            { id: 25, brandId: 2, modelName: "2.8", capacity: "2.8 kW" },
            { id: 26, brandId: 2, modelName: "3.2", capacity: "3.2 kW" },
            { id: 27, brandId: 2, modelName: "3.6", capacity: "3.6 kW" },
            { id: 28, brandId: 2, modelName: "4", capacity: "4 kW" },
            { id: 29, brandId: 2, modelName: "4.5", capacity: "4.5 kW" },
            { id: 30, brandId: 2, modelName: "5", capacity: "5 kW" },
            { id: 31, brandId: 2, modelName: "5.6", capacity: "5.6 kW" },
            { id: 32, brandId: 2, modelName: "6.3", capacity: "6.3 kW" },
            { id: 33, brandId: 2, modelName: "7.1", capacity: "7.1 kW" },
            { id: 34, brandId: 2, modelName: "8", capacity: "8 kW" },
            { id: 35, brandId: 2, modelName: "9", capacity: "9 kW" },
            { id: 36, brandId: 2, modelName: "10", capacity: "10 kW" },
            { id: 37, brandId: 2, modelName: "11.2", capacity: "11.2 kW" },
            { id: 38, brandId: 2, modelName: "12.5", capacity: "12.5 kW" },
            { id: 39, brandId: 2, modelName: "14", capacity: "14 kW" },
            { id: 40, brandId: 2, modelName: "16", capacity: "16 kW" },
            { id: 41, brandId: 3, modelName: "1.8", capacity: "1.8 kW" },
            { id: 42, brandId: 3, modelName: "2.2", capacity: "2.2 kW" },
            { id: 43, brandId: 3, modelName: "2.5", capacity: "2.5 kW" },
            { id: 44, brandId: 3, modelName: "2.8", capacity: "2.8 kW" },
            { id: 45, brandId: 3, modelName: "3.2", capacity: "3.2 kW" },
            { id: 46, brandId: 3, modelName: "3.6", capacity: "3.6 kW" },
            { id: 47, brandId: 3, modelName: "4", capacity: "4 kW" },
            { id: 48, brandId: 3, modelName: "4.5", capacity: "4.5 kW" },
            { id: 49, brandId: 3, modelName: "5", capacity: "5 kW" },
            { id: 50, brandId: 3, modelName: "5.6", capacity: "5.6 kW" },
            { id: 51, brandId: 3, modelName: "6.3", capacity: "6.3 kW" },
            { id: 52, brandId: 3, modelName: "7.1", capacity: "7.1 kW" },
            { id: 53, brandId: 3, modelName: "8", capacity: "8 kW" },
            { id: 54, brandId: 3, modelName: "9", capacity: "9 kW" },
            { id: 55, brandId: 3, modelName: "10", capacity: "10 kW" },
            { id: 56, brandId: 3, modelName: "11.2", capacity: "11.2 kW" },
            { id: 57, brandId: 3, modelName: "12", capacity: "12 kW" },
            { id: 58, brandId: 3, modelName: "16", capacity: "16 kW" },
            { id: 59, brandId: 4, modelName: "1.8", capacity: "1.8 kW" },
            { id: 60, brandId: 4, modelName: "2.2", capacity: "2.2 kW" },
            { id: 61, brandId: 4, modelName: "2.5", capacity: "2.5 kW" },
            { id: 62, brandId: 4, modelName: "2.8", capacity: "2.8 kW" },
            { id: 63, brandId: 4, modelName: "3.2", capacity: "3.2 kW" },
            { id: 64, brandId: 4, modelName: "3.6", capacity: "3.6 kW" },
            { id: 65, brandId: 4, modelName: "4", capacity: "4 kW" },
            { id: 66, brandId: 4, modelName: "4.5", capacity: "4.5 kW" },
            { id: 67, brandId: 4, modelName: "5", capacity: "5 kW" },
            { id: 68, brandId: 4, modelName: "5.6", capacity: "5.6 kW" },
            { id: 69, brandId: 4, modelName: "6.3", capacity: "6.3 kW" },
            { id: 70, brandId: 4, modelName: "7.1", capacity: "7.1 kW" },
            { id: 71, brandId: 4, modelName: "8", capacity: "8 kW" },
            { id: 72, brandId: 4, modelName: "9", capacity: "9 kW" },
            { id: 73, brandId: 4, modelName: "10", capacity: "10 kW" },
            { id: 74, brandId: 4, modelName: "11.2", capacity: "11.2 kW" },
            { id: 75, brandId: 4, modelName: "12", capacity: "12 kW" },
            { id: 76, brandId: 4, modelName: "16", capacity: "16 kW" },
            { id: 77, brandId: 5, modelName: "2.2", capacity: "2.2 kW" },
            { id: 78, brandId: 5, modelName: "2.5", capacity: "2.5 kW" },
            { id: 79, brandId: 5, modelName: "2.8", capacity: "2.8 kW" },
            { id: 80, brandId: 5, modelName: "3.2", capacity: "3.2 kW" },
            { id: 81, brandId: 5, modelName: "3.6", capacity: "3.6 kW" },
            { id: 82, brandId: 5, modelName: "4", capacity: "4 kW" },
            { id: 83, brandId: 5, modelName: "4.5", capacity: "4.5 kW" },
            { id: 84, brandId: 5, modelName: "5", capacity: "5 kW" },
            { id: 85, brandId: 5, modelName: "5.6", capacity: "5.6 kW" },
            { id: 86, brandId: 5, modelName: "6.3", capacity: "6.3 kW" },
            { id: 87, brandId: 5, modelName: "7.1", capacity: "7.1 kW" },
            { id: 88, brandId: 5, modelName: "8", capacity: "8 kW" },
            { id: 90, brandId: 5, modelName: "9", capacity: "9 kW" },
            { id: 91, brandId: 5, modelName: "10", capacity: "10 kW" },
            { id: 92, brandId: 5, modelName: "11.2", capacity: "11.2 kW" },
            { id: 93, brandId: 5, modelName: "12", capacity: "12 kW" },
            { id: 94, brandId: 5, modelName: "16", capacity: "16 kW" },
            { id: 95, brandId: 6, modelName: "1.5", capacity: "1.5 kW" },
            { id: 96, brandId: 6, modelName: "1.8", capacity: "1.8 kW" },
            { id: 97, brandId: 6, modelName: "2.2", capacity: "2.2 kW" },
            { id: 98, brandId: 6, modelName: "2.5", capacity: "2.5 kW" },
            { id: 99, brandId: 6, modelName: "2.8", capacity: "2.8 kW" },
            { id: 100, brandId: 6, modelName: "3.2", capacity: "3.2 kW" },
            { id: 101, brandId: 6, modelName: "3.6", capacity: "3.6 kW" },
            { id: 102, brandId: 6, modelName: "4", capacity: "4 kW" },
            { id: 103, brandId: 6, modelName: "4.5", capacity: "4.5 kW" },
            { id: 104, brandId: 6, modelName: "5", capacity: "5 kW" },
            { id: 105, brandId: 6, modelName: "5.6", capacity: "5.6 kW" },
            { id: 106, brandId: 6, modelName: "6.3", capacity: "6.3 kW" },
            { id: 107, brandId: 6, modelName: "7.1", capacity: "7.1 kW" },
            { id: 108, brandId: 6, modelName: "8", capacity: "8 kW" },
            { id: 109, brandId: 6, modelName: "9", capacity: "9 kW" },
            { id: 110, brandId: 6, modelName: "10", capacity: "10 kW" },
            { id: 111, brandId: 6, modelName: "11.2", capacity: "11.2 kW" },
            { id: 112, brandId: 6, modelName: "12.5", capacity: "12.5 kW" },
            { id: 113, brandId: 6, modelName: "14", capacity: "14 kW" },
            { id: 114, brandId: 6, modelName: "16", capacity: "16 kW" },
        ];

        const pipeSpecs = [
            { modelId: 1, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 2, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 2, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 3, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 3, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 4, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 4, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 5, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 5, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 6, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 6, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 7, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 7, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 8, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 8, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 9, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 9, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 10, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 10, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 11, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 11, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 12, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 12, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 13, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 13, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 14, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 14, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 15, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 15, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 16, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 16, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 17, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 17, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 18, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 18, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 19, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 19, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 20, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 20, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 21, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 21, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 22, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 22, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 23, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 23, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 24, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 24, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 25, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 25, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 26, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 26, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 27, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 27, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 28, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 28, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 29, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 29, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 30, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 30, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 31, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 31, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 32, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 32, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 33, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 33, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 34, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 34, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 35, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 35, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 36, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 36, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 37, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 37, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 38, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 38, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 39, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 39, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 40, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 40, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 41, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 41, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 42, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 42, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 43, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 43, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 44, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 44, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 45, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 45, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 46, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 46, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 47, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 47, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 48, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 48, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 49, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 49, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 50, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 50, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 51, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 51, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 52, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 52, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 53, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 53, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 54, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 54, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 55, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 55, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 56, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 56, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 57, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 57, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 58, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 58, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 59, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 59, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 60, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 60, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 61, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 61, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 62, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 62, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 63, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 63, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 64, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 64, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 65, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 65, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 66, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 66, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 67, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 67, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 68, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 68, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 69, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 69, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 70, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 70, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 71, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 71, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 72, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 72, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 73, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 73, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 74, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 74, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 75, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 75, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 76, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 76, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 77, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 77, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 78, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 78, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 79, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.52" },
            { modelId: 79, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 80, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 80, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 81, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 81, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 82, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 82, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 83, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 83, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 84, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 84, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 85, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 85, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 86, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 86, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 87, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 87, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 88, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 88, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 90, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 90, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 91, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 91, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 92, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 92, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 93, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 93, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 94, pipeType: "æ°”ç®¡", pipeSize: "Î¦19.05" },
            { modelId: 94, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 95, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 95, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 96, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 96, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 97, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 97, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 98, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 98, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 99, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 99, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 100, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 100, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 101, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 101, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 102, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 102, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 103, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 103, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 104, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 104, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 105, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 105, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 106, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 106, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 107, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 107, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 108, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 108, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 109, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 109, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 110, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 110, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 111, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 111, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 112, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 112, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 113, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 113, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 114, pipeType: "æ°”ç®¡", pipeSize: "Î¦15.9" },
            { modelId: 114, pipeType: "æ¶²ç®¡", pipeSize: "Î¦9.5" },
        ];

        // ä¸€æ‹–ä¸€ç‰ˆé¢ç‹¬ç«‹æ•°æ®
        const oneToOneModels = [
            { id: 1001, brandId: 1, modelName: "1.5", capacity: "1.5 HP" },
            { id: 1002, brandId: 1, modelName: "2.0", capacity: "2.0 HP" },
            { id: 1003, brandId: 1, modelName: "2.5", capacity: "2.5 HP" },
            { id: 1004, brandId: 4, modelName: "1.5", capacity: "1.5 HP" },
            { id: 1005, brandId: 4, modelName: "2.0", capacity: "2.0 HP" },
            { id: 1006, brandId: 4, modelName: "2.5", capacity: "2.5 HP" },
            { id: 1007, brandId: 5, modelName: "1.5", capacity: "1.5 HP" },
            { id: 1008, brandId: 5, modelName: "2.0", capacity: "2.0 HP" },
            { id: 1009, brandId: 5, modelName: "2.5", capacity: "2.5 HP" }
        ];

        const oneToOnePipeSpecs = [
            { modelId: 1001, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 1001, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1002, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1002, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1003, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1003, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1004, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 1004, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1005, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1005, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1006, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1006, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1007, pipeType: "æ°”ç®¡", pipeSize: "Î¦9.5" },
            { modelId: 1007, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1008, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1008, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" },
            { modelId: 1009, pipeType: "æ°”ç®¡", pipeSize: "Î¦12.7" },
            { modelId: 1009, pipeType: "æ¶²ç®¡", pipeSize: "Î¦6.3" }
        ];

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„ç‰ˆé¢ç‹¬ç«‹æ•°æ®
const downstreamModels = [
            { id: 1, brandId: 2, modelName: "Aâ‰¤16.8", capacity: "Aâ‰¤16.8 kW" },
            { id: 2, brandId: 2, modelName: "16.8â‰¤A<22.4", capacity: "16.8â‰¤A<22.4 kW" },
            { id: 3, brandId: 2, modelName: "22.4â‰¤A<33.0", capacity: "22.4â‰¤A<33.0 kW" },
            { id: 4, brandId: 2, modelName: "33.0â‰¤A<47.0", capacity: "33.0â‰¤A<47.0 kW" },
            { id: 5, brandId: 2, modelName: "47.0â‰¤A<71.0", capacity: "47.0â‰¤A<71.0 kW" },
            { id: 6, brandId: 2, modelName: "71.0â‰¤A<1040", capacity: "71.0â‰¤A<1040 kW" },
            { id: 7, brandId: 2, modelName: "104.0â‰¤A<154.0", capacity: "104.0â‰¤A<154.0 kW" },
            { id: 8, brandId: 2, modelName: "154.0â‰¤A<190.0", capacity: "154.0â‰¤A<190.0 kW" },
            { id: 9, brandId: 2, modelName: "190.0â‰¤A<235.0", capacity: "190.0â‰¤A<235.0 kW" },
            { id: 10, brandId: 2, modelName: "235.0â‰¤A<250.0", capacity: "235.0â‰¤A<250.0 kW" },
            { id: 11, brandId: 2, modelName: "250.0â‰¤A<302.4", capacity: "250.0â‰¤A<302.4 kW" },
            { id: 12, brandId: 2, modelName: "302.4â‰¤A", capacity: "302.4â‰¤A kW" },
            { id: 13, brandId: 1, modelName: "A<16.8", capacity: "A<16.8 kW" },
            { id: 14, brandId: 1, modelName: "16.8â‰¤A<25.2", capacity: "16.8â‰¤A<25.2 kW" },
            { id: 15, brandId: 1, modelName: "25.2â‰¤A<33.5", capacity: "25.2â‰¤A<33.5 kW" },
            { id: 16, brandId: 1, modelName: "33.5â‰¤A<45.0", capacity: "33.5â‰¤A<45.0 kW" },
            { id: 17, brandId: 1, modelName: "45.0â‰¤A<50.4", capacity: "45.0â‰¤A<50.4 kW" },
            { id: 18, brandId: 1, modelName: "50.4â‰¤A<72.8", capacity: "50.4â‰¤A<72.8 kW" },
            { id: 19, brandId: 1, modelName: "72.8â‰¤A<100.8", capacity: "72.8â‰¤A<100.8 kW" },
            { id: 20, brandId: 1, modelName: "100.8â‰¤A<134.4", capacity: "100.8â‰¤A<134.4 kW" },
            { id: 21, brandId: 1, modelName: "134.4â‰¤A<162.4", capacity: "134.4â‰¤A<162.4 kW" },
            { id: 22, brandId: 1, modelName: "162.4â‰¤A<235.2", capacity: "162.4â‰¤A<235.2 kW" },
            { id: 23, brandId: 1, modelName: "235.2â‰¤A<313.6", capacity: "235.2â‰¤A<313.6 kW" },
            { id: 24, brandId: 1, modelName: "313.6â‰¤A<403.2", capacity: "313.6â‰¤A<403.2 kW" },
            { id: 25, brandId: 1, modelName: "A<16", capacity: "A<16 kW" },
            { id: 26, brandId: 1, modelName: "16â‰¤A<25", capacity: "16â‰¤A<25 kW" },
            { id: 27, brandId: 1, modelName: "25â‰¤A<33.5", capacity: "25â‰¤A<33.5 kW" },
            { id: 28, brandId: 1, modelName: "33.5â‰¤A<45", capacity: "33.5â‰¤A<45 kW" },
            { id: 29, brandId: 1, modelName: "45â‰¤A<50.4", capacity: "45â‰¤A<50.4 kW" },
            { id: 30, brandId: 1, modelName: "50.4â‰¤A<72.9", capacity: "50.4â‰¤A<72.9 kW" },
            { id: 31, brandId: 1, modelName: "72.9â‰¤A<100.8", capacity: "72.9â‰¤A<100.8 kW" },
            { id: 32, brandId: 1, modelName: "100.8â‰¤A<156.8", capacity: "100.8â‰¤A<156.8 kW" },
            { id: 33, brandId: 1, modelName: "156.8â‰¤A<190.4", capacity: "156.8â‰¤A<190.4 kW" },
            { id: 34, brandId: 1, modelName: "190.4â‰¤A<207.2", capacity: "190.4â‰¤A<207.2 kW" },
            { id: 35, brandId: 1, modelName: "207.2â‰¤A<252", capacity: "207.2â‰¤A<252 kW" },
            { id: 36, brandId: 1, modelName: "252â‰¤A", capacity: "252â‰¤A kW" },
            { id: 37, brandId: 3, modelName: "7.0æœªæ»¡", capacity: "7.0æœªæ»¡ kW" },
            { id: 38, brandId: 3, modelName: "7.0ä»¥ä¸Š~18.0æœªæ»¡", capacity: "7.0ä»¥ä¸Š~18.0æœªæ»¡ kW" },
            { id: 39, brandId: 3, modelName: "18.0ä»¥ä¸Š~37.1æœªæ»¡", capacity: "18.0ä»¥ä¸Š~37.1æœªæ»¡ kW" },
            { id: 40, brandId: 3, modelName: "37.1ä»¥ä¸Š~54.0æœªæ»¡", capacity: "37.1ä»¥ä¸Š~54.0æœªæ»¡ kW" },
            { id: 41, brandId: 3, modelName: "54.0ä»¥ä¸Š~70.0æœªæ»¡", capacity: "54.0ä»¥ä¸Š~70.0æœªæ»¡ kW" },
            { id: 42, brandId: 3, modelName: "70.0ä»¥ä¸Š~110.0æœªæ»¡", capacity: "70.0ä»¥ä¸Š~110.0æœªæ»¡ kW" },
            { id: 43, brandId: 3, modelName: "110.0ä»¥ä¸Š~156.0æœªæ»¡", capacity: "110.0ä»¥ä¸Š~156.0æœªæ»¡ kW" },
            { id: 44, brandId: 3, modelName: "156.0ä»¥ä¸Š~186.0æœªæ»¡", capacity: "156.0ä»¥ä¸Š~186.0æœªæ»¡ kW" },
            { id: 45, brandId: 3, modelName: "186.0ä»¥ä¸Š~220.5", capacity: "186.0ä»¥ä¸Š~220.5 kW" },
            { id: 46, brandId: 6, modelName: "ï¼œ16.8KW", capacity: "ï¼œ16.8KW kW" },
            { id: 47, brandId: 6, modelName: "16.8â‰¤Xï¼œ22.4KW", capacity: "16.8â‰¤Xï¼œ22.4KW kW" },
            { id: 48, brandId: 6, modelName: "22.4â‰¤Xï¼œ33.0KW", capacity: "22.4â‰¤Xï¼œ33.0KW kW" },
            { id: 49, brandId: 6, modelName: "33.0â‰¤Xï¼œ47.0KW", capacity: "33.0â‰¤Xï¼œ47.0KW kW" }
        ];

        const downstreamPipeSpecs = [
            { modelId: 1, pipeType: "æ°”ç®¡", pipeSize: "15.9mm" },
            { modelId: 1, pipeType: "æ¶²ç®¡", pipeSize: "9.5mm" },
            { modelId: 1, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 01C" },
            { modelId: 2, pipeType: "æ°”ç®¡", pipeSize: "19.1mm" },
            { modelId: 2, pipeType: "æ¶²ç®¡", pipeSize: "9.5mm" },
            { modelId: 2, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 01C" },
            { modelId: 3, pipeType: "æ°”ç®¡", pipeSize: "22.2mm" },
            { modelId: 3, pipeType: "æ¶²ç®¡", pipeSize: "9.5mm" },
            { modelId: 3, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 02C" },
            { modelId: 4, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 4, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 4, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 03C" },
            { modelId: 5, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 5, pipeType: "æ¶²ç®¡", pipeSize: "15.9mm" },
            { modelId: 5, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 03C" },
            { modelId: 6, pipeType: "æ°”ç®¡", pipeSize: "31.8mm" },
            { modelId: 6, pipeType: "æ¶²ç®¡", pipeSize: "19.1mm" },
            { modelId: 6, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 03C" },
            { modelId: 7, pipeType: "æ°”ç®¡", pipeSize: "38.1mm" },
            { modelId: 7, pipeType: "æ¶²ç®¡", pipeSize: "19.1mm" },
            { modelId: 7, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 04C" },
            { modelId: 8, pipeType: "æ°”ç®¡", pipeSize: "41.3mm" },
            { modelId: 8, pipeType: "æ¶²ç®¡", pipeSize: "19.1mm" },
            { modelId: 8, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 05C" },
            { modelId: 9, pipeType: "æ°”ç®¡", pipeSize: "44.5mm" },
            { modelId: 9, pipeType: "æ¶²ç®¡", pipeSize: "22.2mm" },
            { modelId: 9, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 05C" },
            { modelId: 10, pipeType: "æ°”ç®¡", pipeSize: "50.8mm" },
            { modelId: 10, pipeType: "æ¶²ç®¡", pipeSize: "22.2mm" },
            { modelId: 10, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 06C" },
            { modelId: 11, pipeType: "æ°”ç®¡", pipeSize: "50.8mm" },
            { modelId: 11, pipeType: "æ¶²ç®¡", pipeSize: "25.4mm" },
            { modelId: 11, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 06C" },
            { modelId: 12, pipeType: "æ°”ç®¡", pipeSize: "54mm" },
            { modelId: 12, pipeType: "æ¶²ç®¡", pipeSize: "28.6mm" },
            { modelId: 12, pipeType: "åˆ†æ­§ç®¡", pipeSize: "FQZHN - 07C" },
            { modelId: 13, pipeType: "æ°”ç®¡", pipeSize: "15.88mm" },
            { modelId: 13, pipeType: "æ¶²ç®¡", pipeSize: "9.53mm" },
            { modelId: 13, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 102F" },
            { modelId: 14, pipeType: "æ°”ç®¡", pipeSize: "19.05mm" },
            { modelId: 14, pipeType: "æ¶²ç®¡", pipeSize: "9.53mm" },
            { modelId: 14, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 102F" },
            { modelId: 15, pipeType: "æ°”ç®¡", pipeSize: "22.2mm" },
            { modelId: 15, pipeType: "æ¶²ç®¡", pipeSize: "9.53mm" },
            { modelId: 15, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 102F" },
            { modelId: 16, pipeType: "æ°”ç®¡", pipeSize: "25.4mm" },
            { modelId: 16, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 16, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 162F" },
            { modelId: 17, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 17, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 17, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 162F" },
            { modelId: 18, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 18, pipeType: "æ¶²ç®¡", pipeSize: "15.88mm" },
            { modelId: 18, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 242F" },
            { modelId: 19, pipeType: "æ°”ç®¡", pipeSize: "31.75mm" },
            { modelId: 19, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 19, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 302F" },
            { modelId: 20, pipeType: "æ°”ç®¡", pipeSize: "38.1mm" },
            { modelId: 20, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 20, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 302F" },
            { modelId: 21, pipeType: "æ°”ç®¡", pipeSize: "41.3mm" },
            { modelId: 21, pipeType: "æ¶²ç®¡", pipeSize: "22.2mm" },
            { modelId: 21, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 562F" },
            { modelId: 22, pipeType: "æ°”ç®¡", pipeSize: "44.5mm" },
            { modelId: 22, pipeType: "æ¶²ç®¡", pipeSize: "22.2mm" },
            { modelId: 22, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 562F" },
            { modelId: 23, pipeType: "æ°”ç®¡", pipeSize: "50.8mm" },
            { modelId: 23, pipeType: "æ¶²ç®¡", pipeSize: "25.4mm" },
            { modelId: 23, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 682F" },
            { modelId: 24, pipeType: "æ°”ç®¡", pipeSize: "53.98mm" },
            { modelId: 24, pipeType: "æ¶²ç®¡", pipeSize: "28.6mm" },
            { modelId: 24, pipeType: "åˆ†æ­§ç®¡", pipeSize: "HFQ - 682F" },
            { modelId: 25, pipeType: "æ°”ç®¡", pipeSize: "15.88mm" },
            { modelId: 25, pipeType: "æ¶²ç®¡", pipeSize: "9.53mm" },
            { modelId: 25, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 102SN" },
            { modelId: 26, pipeType: "æ°”ç®¡", pipeSize: "19.05mm" },
            { modelId: 26, pipeType: "æ¶²ç®¡", pipeSize: "9.53mm" },
            { modelId: 26, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 102SN" },
            { modelId: 27, pipeType: "æ°”ç®¡", pipeSize: "22.2mm" },
            { modelId: 27, pipeType: "æ¶²ç®¡", pipeSize: "9.53mm" },
            { modelId: 27, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 102SN" },
            { modelId: 28, pipeType: "æ°”ç®¡", pipeSize: "25.4mm" },
            { modelId: 28, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 28, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 162SN" },
            { modelId: 29, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 29, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 29, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 162SN" },
            { modelId: 30, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 30, pipeType: "æ¶²ç®¡", pipeSize: "15.88mm" },
            { modelId: 30, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 242SN" },
            { modelId: 31, pipeType: "æ°”ç®¡", pipeSize: "31.75mm" },
            { modelId: 31, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 31, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 302SN" },
            { modelId: 32, pipeType: "æ°”ç®¡", pipeSize: "38.1mm" },
            { modelId: 32, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 32, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 302SN" },
            { modelId: 33, pipeType: "æ°”ç®¡", pipeSize: "44.5mm" },
            { modelId: 33, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 33, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 462SN" },
            { modelId: 34, pipeType: "æ°”ç®¡", pipeSize: "44.5mm" },
            { modelId: 34, pipeType: "æ¶²ç®¡", pipeSize: "22.2mm" },
            { modelId: 34, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 462SN" },
            { modelId: 35, pipeType: "æ°”ç®¡", pipeSize: "50.8mm" },
            { modelId: 35, pipeType: "æ¶²ç®¡", pipeSize: "22.2mm" },
            { modelId: 35, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 682SN" },
            { modelId: 36, pipeType: "æ°”ç®¡", pipeSize: "50.8mm" },
            { modelId: 36, pipeType: "æ¶²ç®¡", pipeSize: "25.4mm" },
            { modelId: 36, pipeType: "åˆ†æ­§ç®¡", pipeSize: "E - 682SN" },
            { modelId: 37, pipeType: "æ°”ç®¡", pipeSize: "12.7mm" },
            { modelId: 37, pipeType: "æ¶²ç®¡", pipeSize: "9.52mm" },
            { modelId: 37, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-22-1" },
            { modelId: 38, pipeType: "æ°”ç®¡", pipeSize: "15.88mm" },
            { modelId: 38, pipeType: "æ¶²ç®¡", pipeSize: "9.52mm" },
            { modelId: 38, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-22-1" },
            { modelId: 39, pipeType: "æ°”ç®¡", pipeSize: "19.05mm" },
            { modelId: 39, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 39, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-180-1" },
            { modelId: 40, pipeType: "æ°”ç®¡", pipeSize: "25.4mm" },
            { modelId: 40, pipeType: "æ¶²ç®¡", pipeSize: "15.88mm" },
            { modelId: 40, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-371-1" },
            { modelId: 41, pipeType: "æ°”ç®¡", pipeSize: "28.58mm" },
            { modelId: 41, pipeType: "æ¶²ç®¡", pipeSize: "15.88mm" },
            { modelId: 41, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-540-1" },
            { modelId: 42, pipeType: "æ°”ç®¡", pipeSize: "31.8mm" },
            { modelId: 42, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 42, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-540-1" },
            { modelId: 43, pipeType: "æ°”ç®¡", pipeSize: "38.1mm" },
            { modelId: 43, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 43, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-1450-1" },
            { modelId: 44, pipeType: "æ°”ç®¡", pipeSize: "41.3mm" },
            { modelId: 44, pipeType: "æ¶²ç®¡", pipeSize: "19.05mm" },
            { modelId: 44, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-1450-1" },
            { modelId: 45, pipeType: "æ°”ç®¡", pipeSize: "44.5mm" },
            { modelId: 45, pipeType: "æ¶²ç®¡", pipeSize: "22.22mm" },
            { modelId: 45, pipeType: "åˆ†æ­§ç®¡", pipeSize: "DIS-1450-1" },
            { modelId: 46, pipeType: "æ°”ç®¡", pipeSize: "15.9mm" },
            { modelId: 46, pipeType: "æ¶²ç®¡", pipeSize: "9.5mm" },
            { modelId: 46, pipeType: "åˆ†æ­§ç®¡", pipeSize: "KHRP26NC22T" },
            { modelId: 47, pipeType: "æ°”ç®¡", pipeSize: "19.1mm" },
            { modelId: 47, pipeType: "æ¶²ç®¡", pipeSize: "9.5mm" },
            { modelId: 47, pipeType: "åˆ†æ­§ç®¡", pipeSize: "KHRP26NC22T" },
            { modelId: 48, pipeType: "æ°”ç®¡", pipeSize: "22.2mm" },
            { modelId: 48, pipeType: "æ¶²ç®¡", pipeSize: "9.5mm" },
            { modelId: 48, pipeType: "åˆ†æ­§ç®¡", pipeSize: "KHRP26NC33T" },
            { modelId: 49, pipeType: "æ°”ç®¡", pipeSize: "28.6mm" },
            { modelId: 49, pipeType: "æ¶²ç®¡", pipeSize: "12.7mm" },
            { modelId: 49, pipeType: "åˆ†æ­§ç®¡", pipeSize: "KHRP26NC72T" }
        ];

        // ============ æƒé™ç®¡ç† ============
        const ADMIN_USERNAME = 'admin';
        const ADMIN_PASSWORD = 'admin123';
        const USER_USERNAME = 'user';
        const USER_PASSWORD = 'user123';

        // ä¼˜å…ˆä» localStorage è¯»å–ç™»å½•çŠ¶æ€ï¼ˆè®°ä½æˆ‘ï¼‰ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä» sessionStorage è¯»å–
        let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true' || sessionStorage.getItem('session_isLoggedIn') === 'true';
        let isAdmin = localStorage.getItem('isAdmin') === 'true' || sessionStorage.getItem('session_isAdmin') === 'true';

        // DOMå…ƒç´  - æƒé™ç®¡ç†ç›¸å…³
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginModal = document.getElementById('loginModal');
        const loginSubmitBtn = document.getElementById('loginSubmitBtn');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const adminPanel = document.getElementById('adminPanel');

        // DOMå…ƒç´  - æŸ¥è¯¢ç›¸å…³ï¼ˆå¿…é¡»åœ¨å®šä¹‰å‡½æ•°å‰å£°æ˜ï¼‰
        const brandSelect = document.getElementById('brandSelect');
        const modelSelect = document.getElementById('modelSelect');
        const resultContainer = document.getElementById('resultContainer');
        const pipeSpecsContainer = document.getElementById('pipeSpecs');
        const noDataMessage = document.getElementById('noDataMessage');

        // ä¸€æ‹–ä¸€é¡µé¢DOMå…ƒç´ 
        const brandSelect2 = document.getElementById('brandSelect2');
        const modelSelect2 = document.getElementById('modelSelect2');
        const resultContainer2 = document.getElementById('resultContainer2');
        const pipeSpecsContainer2 = document.getElementById('pipeSpecs2');
        const noDataMessage2 = document.getElementById('noDataMessage2');

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢DOMå…ƒç´ 
        const brandSelect3 = document.getElementById('brandSelect3');
        const modelSelect3 = document.getElementById('modelSelect3');
        const resultContainer3 = document.getElementById('resultContainer3');
        const pipeSpecsContainer3 = document.getElementById('pipeSpecs3');
        const noDataMessage3 = document.getElementById('noDataMessage3');
        const totalCapacity3 = document.getElementById('totalCapacity3');
        const clearAllBtn3 = document.getElementById('clearAllBtn3');
        const indoorUnitsContainer = document.getElementById('indoorUnitsContainer');
        const indoorUnitsScrollContainer = document.getElementById('indoorUnitsScrollContainer');

        // è°ƒè¯•ï¼šæ£€æŸ¥æ‰€æœ‰DOMå…ƒç´ æ˜¯å¦æ­£ç¡®è·å–
        console.log('=== DOMå…ƒç´ è·å–æ£€æŸ¥ ===');
        console.log('brandSelect:', brandSelect ? 'OK' : 'NULL');
        console.log('brandSelect2:', brandSelect2 ? 'OK' : 'NULL');
        console.log('brandSelect3:', brandSelect3 ? 'OK' : 'NULL');
        console.log('adminPanel:', adminPanel ? 'OK' : 'NULL');

        // ============ ç™»å½•ç›¸å…³äº‹ä»¶ ============
        // ç™»å½•æŒ‰é’®ç‚¹å‡»
        loginBtn.addEventListener('click', () => {
            console.log('ç‚¹å‡»ç™»å½•æŒ‰é’®');
            loginModal.classList.remove('hidden');
        });

        // æäº¤ç™»å½•
        loginSubmitBtn.addEventListener('click', () => {
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();
            const rememberMe = document.getElementById('rememberMe').checked;
            console.log('å°è¯•ç™»å½• - ç”¨æˆ·å:', username, 'è®°ä½æˆ‘:', rememberMe);

            // ç®¡ç†å‘˜ç™»å½•
            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                console.log('ç®¡ç†å‘˜ç™»å½•æˆåŠŸ');
                isLoggedIn = true;
                isAdmin = true;
                if (rememberMe) {
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('isAdmin', 'true');
                    localStorage.removeItem('session_isLoggedIn');
                    localStorage.removeItem('session_isAdmin');
                } else {
                    sessionStorage.setItem('session_isLoggedIn', 'true');
                    sessionStorage.setItem('session_isAdmin', 'true');
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('isAdmin');
                }
                loginModal.classList.add('hidden');
                usernameInput.value = '';
                passwordInput.value = '';
                updateUI();
                alert('ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼');
            }
            // æ™®é€šç”¨æˆ·ç™»å½•
            else if (username === USER_USERNAME && password === USER_PASSWORD) {
                console.log('æ™®é€šç”¨æˆ·ç™»å½•æˆåŠŸ');
                isLoggedIn = true;
                isAdmin = false;
                if (rememberMe) {
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('isAdmin', 'false');
                    localStorage.removeItem('session_isLoggedIn');
                    localStorage.removeItem('session_isAdmin');
                } else {
                    sessionStorage.setItem('session_isLoggedIn', 'true');
                    sessionStorage.setItem('session_isAdmin', 'false');
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('isAdmin');
                }
                loginModal.classList.add('hidden');
                usernameInput.value = '';
                passwordInput.value = '';
                updateUI();
                alert('ç™»å½•æˆåŠŸï¼');
            }
            else {
                console.log('ç™»å½•å¤±è´¥ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯');
                alert('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼');
            }
        });

        // ç™»å‡ºæŒ‰é’®ç‚¹å‡»
        logoutBtn.addEventListener('click', () => {
            console.log('ç‚¹å‡»ç™»å‡ºæŒ‰é’®');
            isLoggedIn = false;
            isAdmin = false;
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('isAdmin');
            sessionStorage.removeItem('session_isLoggedIn');
            sessionStorage.removeItem('session_isAdmin');
            updateUI();
            alert('å·²é€€å‡ºç™»å½•ï¼');
        });

        // ============ UIæ›´æ–°å‡½æ•° ============

        // æ›´æ–°UIæ˜¾ç¤º
        function updateUI() {
            try {
                console.log('=== æ›´æ–°UI ===');
                console.log('å½“å‰ç™»å½•çŠ¶æ€:', isLoggedIn);
                console.log('æ˜¯å¦ç®¡ç†å‘˜:', isAdmin);
                console.log('adminPanelå…ƒç´ :', adminPanel);
                console.log('adminPanel classList:', adminPanel ? adminPanel.classList.value : 'NULL');

                const loginWelcome = document.getElementById('loginWelcome');
                const mainContent = document.getElementById('mainContent');

                if (isLoggedIn) {
                    // ç™»å½•çŠ¶æ€ï¼šæ˜¾ç¤ºä¸»é¡µé¢ï¼Œéšè—ç™»å½•æ¬¢è¿é¡µ
                    if (loginWelcome) loginWelcome.classList.add('hidden');
                    if (mainContent) mainContent.classList.remove('hidden');

                    loginBtn.classList.add('hidden');
                    logoutBtn.classList.remove('hidden');
                    console.log('å·²ç™»å½• - æ˜¾ç¤ºç™»å‡ºæŒ‰é’®');

                    // åªæœ‰ç®¡ç†å‘˜æ‰èƒ½çœ‹åˆ°ç®¡ç†é¢æ¿å’Œç®¡ç†æŒ‰é’®
                    if (isAdmin) {
                        console.log('ç®¡ç†å‘˜ç™»å½• - æ˜¾ç¤ºç®¡ç†é¢æ¿');
                        // adminPanelå¯èƒ½ä¸å­˜åœ¨ï¼Œæ·»åŠ ç©ºå€¼æ£€æŸ¥
                        if (adminPanel) {
                            adminPanel.classList.remove('hidden');
                        }
                        // æ˜¾ç¤ºå„ä¸ªç‰ˆé¢çš„ç®¡ç†æŒ‰é’®
                        const adminButtonsMulti = document.getElementById('adminButtonsMulti');
                        const adminButtonsOneToOne = document.getElementById('adminButtonsOneToOne');
                        const adminButtonsDownstream = document.getElementById('adminButtonsDownstream');
                        if (adminButtonsMulti) adminButtonsMulti.classList.remove('hidden');
                        if (adminButtonsOneToOne) adminButtonsOneToOne.classList.remove('hidden');
                        if (adminButtonsDownstream) adminButtonsDownstream.classList.remove('hidden');
                    } else {
                        console.log('æ™®é€šç”¨æˆ·ç™»å½• - éšè—ç®¡ç†é¢æ¿');
                        // adminPanelå¯èƒ½ä¸å­˜åœ¨ï¼Œæ·»åŠ ç©ºå€¼æ£€æŸ¥
                        if (adminPanel) {
                            adminPanel.classList.add('hidden');
                        }
                        // éšè—å„ä¸ªç‰ˆé¢çš„ç®¡ç†æŒ‰é’®
                        const adminButtonsMulti = document.getElementById('adminButtonsMulti');
                        const adminButtonsOneToOne = document.getElementById('adminButtonsOneToOne');
                        const adminButtonsDownstream = document.getElementById('adminButtonsDownstream');
                        if (adminButtonsMulti) adminButtonsMulti.classList.add('hidden');
                        if (adminButtonsOneToOne) adminButtonsOneToOne.classList.add('hidden');
                        if (adminButtonsDownstream) adminButtonsDownstream.classList.add('hidden');
                    }
                    // å¯ç”¨æŸ¥è¯¢åŠŸèƒ½
                    enableQueryFunctions();
                } else {
                    // æœªç™»å½•çŠ¶æ€ï¼šæ˜¾ç¤ºç™»å½•æ¬¢è¿é¡µï¼Œéšè—ä¸»é¡µé¢
                    if (loginWelcome) loginWelcome.classList.remove('hidden');
                    if (mainContent) mainContent.classList.add('hidden');

                    loginBtn.classList.add('hidden');
                    logoutBtn.classList.add('hidden');
                    // adminPanelå¯èƒ½ä¸å­˜åœ¨ï¼Œæ·»åŠ ç©ºå€¼æ£€æŸ¥
                    if (adminPanel) {
                        adminPanel.classList.add('hidden');
                    }
                    // éšè—å„ä¸ªç‰ˆé¢çš„ç®¡ç†æŒ‰é’®
                    const adminButtonsMulti = document.getElementById('adminButtonsMulti');
                    const adminButtonsOneToOne = document.getElementById('adminButtonsOneToOne');
                    const adminButtonsDownstream = document.getElementById('adminButtonsDownstream');
                    if (adminButtonsMulti) adminButtonsMulti.classList.add('hidden');
                    if (adminButtonsOneToOne) adminButtonsOneToOne.classList.add('hidden');
                    if (adminButtonsDownstream) adminButtonsDownstream.classList.add('hidden');
                    // ç¦ç”¨æŸ¥è¯¢åŠŸèƒ½
                    disableQueryFunctions();
                }
            } catch (error) {
                console.error('updateUI é”™è¯¯:', error);
            }
        }

        // ç¦ç”¨æŸ¥è¯¢åŠŸèƒ½
        function disableQueryFunctions() {
            try {
                console.log('=== ç¦ç”¨æŸ¥è¯¢åŠŸèƒ½ ===');

                // ç¦ç”¨å¤šè”æœºå†…æœºé¡µé¢
                if (brandSelect && modelSelect) {
                    console.log('ç¦ç”¨å‰ - brandSelecté€‰é¡¹æ•°:', brandSelect.options.length);
                    brandSelect.disabled = true;
                    modelSelect.disabled = true;
                    resultContainer.classList.add('hidden');
                    noDataMessage.classList.add('hidden');
                    document.getElementById('loginTip1').classList.remove('hidden');
                }

                // ç¦ç”¨ä¸€æ‹–ä¸€é¡µé¢
                if (brandSelect2 && modelSelect2) {
                    console.log('ç¦ç”¨å‰ - brandSelect2é€‰é¡¹æ•°:', brandSelect2.options.length);
                    brandSelect2.disabled = true;
                    modelSelect2.disabled = true;
                    resultContainer2.classList.add('hidden');
                    noDataMessage2.classList.add('hidden');
                    document.getElementById('loginTip2').classList.remove('hidden');
                }

                // ç¦ç”¨å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢
                if (brandSelect3) {
                    console.log('ç¦ç”¨å‰ - brandSelect3é€‰é¡¹æ•°:', brandSelect3.options.length);
                    brandSelect3.disabled = true;
                    resultContainer3.classList.add('hidden');
                    noDataMessage3.classList.add('hidden');
                    document.getElementById('loginTip3').classList.remove('hidden');
                }
            } catch (error) {
                console.error('disableQueryFunctions é”™è¯¯:', error);
            }
        }

        // å¯ç”¨æŸ¥è¯¢åŠŸèƒ½
        function enableQueryFunctions() {
            try {
                console.log('=== å¯ç”¨æŸ¥è¯¢åŠŸèƒ½ ===');
                console.log('ç™»å½•çŠ¶æ€:', isLoggedIn);

                // å¯ç”¨å¤šè”æœºå†…æœºé¡µé¢
                if (brandSelect) {
                    console.log('å¤šè”æœºå†…æœºé¡µé¢ - å“ç‰Œé€‰æ‹©å™¨é€‰é¡¹æ•°:', brandSelect.options.length);
                    brandSelect.disabled = false;
                    document.getElementById('loginTip1').classList.add('hidden');
                }

                // å¯ç”¨ä¸€æ‹–ä¸€é¡µé¢
                if (brandSelect2) {
                    console.log('ä¸€æ‹–ä¸€é¡µé¢ - å“ç‰Œé€‰æ‹©å™¨é€‰é¡¹æ•°:', brandSelect2.options.length);
                    // ç¡®ä¿å“ç‰Œé€‰æ‹©å™¨å·²åˆå§‹åŒ–ï¼ˆåªæœ‰é»˜è®¤é€‰é¡¹æ—¶æ‰åˆå§‹åŒ–ï¼‰
                    if (brandSelect2.options.length <= 1) {
                        console.log('åˆå§‹åŒ–ä¸€æ‹–ä¸€å“ç‰Œé€‰æ‹©å™¨');
                        initBrandSelect2();
                    } else {
                        console.log('ä¸€æ‹–ä¸€å“ç‰Œé€‰æ‹©å™¨å·²åˆå§‹åŒ–ï¼Œè·³è¿‡');
                    }
                    brandSelect2.disabled = false;
                    document.getElementById('loginTip2').classList.add('hidden');
                }

                // å¯ç”¨å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢
                if (brandSelect3) {
                    console.log('å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ - å“ç‰Œé€‰æ‹©å™¨é€‰é¡¹æ•°:', brandSelect3.options.length);
                    // ç¡®ä¿å“ç‰Œé€‰æ‹©å™¨å·²åˆå§‹åŒ–ï¼ˆåªæœ‰é»˜è®¤é€‰é¡¹æ—¶æ‰åˆå§‹åŒ–ï¼‰
                    if (brandSelect3.options.length <= 1) {
                        console.log('åˆå§‹åŒ–å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å“ç‰Œé€‰æ‹©å™¨');
                        initBrandSelect3();
                    } else {
                        console.log('å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å“ç‰Œé€‰æ‹©å™¨å·²åˆå§‹åŒ–ï¼Œè·³è¿‡');
                    }
                    brandSelect3.disabled = false;
                    document.getElementById('loginTip3').classList.add('hidden');
                }
            } catch (error) {
                console.error('enableQueryFunctions é”™è¯¯:', error);
            }
        }

        // ============ æ•°æ®ç®¡ç† ============


        // å¯¼å‡ºå¤šè”æœºå†…æœºæ•°æ®ï¼ˆåˆ†åˆ—æ ¼å¼ï¼‰
        document.getElementById('exportMultiBtn').addEventListener('click', () => {
            console.log('=== å¼€å§‹å¯¼å‡ºå¤šè”æœºå†…æœºæ•°æ® ===');
            try {
                const dateStr = new Date().toISOString().slice(0, 10);
                const workbook = XLSX.utils.book_new();
                const data = [];

                models.forEach(model => {
                    const brand = brands.find(b => b.id === model.brandId);
                    const specs = pipeSpecs.filter(ps => ps.modelId === model.id);

                    const gasPipe = specs.find(s => s.pipeType === 'æ°”ç®¡')?.pipeSize || '';
                    const liquidPipe = specs.find(s => s.pipeType === 'æ¶²ç®¡')?.pipeSize || '';

                    data.push({
                        'å“ç‰Œ': brand ? brand.name : '',
                        'è®¾å¤‡å†·é‡': model.modelName,
                        'æ°”ç®¡': gasPipe,
                        'æ¶²ç®¡': liquidPipe
                    });
                });

                const sheet = XLSX.utils.json_to_sheet(data);
                XLSX.utils.book_append_sheet(workbook, sheet, 'å¤šè”æœºå†…æœºç®¡å¾„æ•°æ®');
                XLSX.writeFile(workbook, `å¤šè”æœºå†…æœºæ•°æ®_${dateStr}.xlsx`);
                console.log('å¤šè”æœºå†…æœºæ•°æ®å¯¼å‡ºæˆåŠŸ');
                alert(`å¤šè”æœºå†…æœºæ•°æ®å¯¼å‡ºæˆåŠŸï¼\næ–‡ä»¶åï¼šå¤šè”æœºå†…æœºæ•°æ®_${dateStr}.xlsx`);
            } catch (error) {
                console.error('å¯¼å‡ºå¤±è´¥:', error);
                alert('æ•°æ®å¯¼å‡ºå¤±è´¥ï¼š' + error.message);
            }
        });

        // å¯¼å‡ºä¸€æ‹–ä¸€æ•°æ®ï¼ˆåˆ†åˆ—æ ¼å¼ï¼‰
        document.getElementById('exportOneToOneBtn').addEventListener('click', () => {
            console.log('=== å¼€å§‹å¯¼å‡ºä¸€æ‹–ä¸€æ•°æ® ===');
            try {
                const dateStr = new Date().toISOString().slice(0, 10);
                const workbook = XLSX.utils.book_new();
                const data = [];

                oneToOneModels.forEach(model => {
                    const brand = brands.find(b => b.id === model.brandId);
                    const specs = oneToOnePipeSpecs.filter(ps => ps.modelId === model.id);

                    const gasPipe = specs.find(s => s.pipeType === 'æ°”ç®¡')?.pipeSize || '';
                    const liquidPipe = specs.find(s => s.pipeType === 'æ¶²ç®¡')?.pipeSize || '';

                    data.push({
                        'å“ç‰Œ': brand ? brand.name : '',
                        'è®¾å¤‡å†·é‡': model.modelName,
                        'æ°”ç®¡': gasPipe,
                        'æ¶²ç®¡': liquidPipe
                    });
                });

                const sheet = XLSX.utils.json_to_sheet(data);
                XLSX.utils.book_append_sheet(workbook, sheet, 'ä¸€æ‹–ä¸€ç®¡å¾„æ•°æ®');
                XLSX.writeFile(workbook, `ä¸€æ‹–ä¸€æ•°æ®_${dateStr}.xlsx`);
                console.log('ä¸€æ‹–ä¸€æ•°æ®å¯¼å‡ºæˆåŠŸ');
                alert(`ä¸€æ‹–ä¸€æ•°æ®å¯¼å‡ºæˆåŠŸï¼\næ–‡ä»¶åï¼šä¸€æ‹–ä¸€æ•°æ®_${dateStr}.xlsx`);
            } catch (error) {
                console.error('å¯¼å‡ºå¤±è´¥:', error);
                alert('æ•°æ®å¯¼å‡ºå¤±è´¥ï¼š' + error.message);
            }
        });

        // å¯¼å‡ºä¸‹æ¸¸ç®¡å¾„æ•°æ®ï¼ˆåˆ†åˆ—æ ¼å¼ï¼‰
        document.getElementById('exportDownstreamBtn').addEventListener('click', () => {
            console.log('=== å¼€å§‹å¯¼å‡ºä¸‹æ¸¸ç®¡å¾„æ•°æ® ===');
            try {
                const dateStr = new Date().toISOString().slice(0, 10);
                const workbook = XLSX.utils.book_new();
                const data = [];

                downstreamModels.forEach(model => {
                    const brand = brands.find(b => b.id === model.brandId);
                    const specs = downstreamPipeSpecs.filter(ps => ps.modelId === model.id);

                    const gasPipe = specs.find(s => s.pipeType === 'æ°”ç®¡')?.pipeSize || '';
                    const liquidPipe = specs.find(s => s.pipeType === 'æ¶²ç®¡')?.pipeSize || '';
                    const branchPipe = specs.find(s => s.pipeType === 'åˆ†æ­§ç®¡')?.pipeSize || '';

                    data.push({
                        'å“ç‰Œ': brand ? brand.name : '',
                        'è®¾å¤‡å†·é‡': model.modelName,
                        'æ°”ç®¡': gasPipe,
                        'æ¶²ç®¡': liquidPipe,
                        'åˆ†æ­§ç®¡': branchPipe
                    });
                });

                const sheet = XLSX.utils.json_to_sheet(data);
                XLSX.utils.book_append_sheet(workbook, sheet, 'ä¸‹æ¸¸ç®¡å¾„æ•°æ®');
                XLSX.writeFile(workbook, `ä¸‹æ¸¸ç®¡å¾„æ•°æ®_${dateStr}.xlsx`);
                console.log('ä¸‹æ¸¸ç®¡å¾„æ•°æ®å¯¼å‡ºæˆåŠŸ');
                alert(`ä¸‹æ¸¸ç®¡å¾„æ•°æ®å¯¼å‡ºæˆåŠŸï¼\næ–‡ä»¶åï¼šä¸‹æ¸¸ç®¡å¾„æ•°æ®_${dateStr}.xlsx`);
            } catch (error) {
                console.error('å¯¼å‡ºå¤±è´¥:', error);
                alert('æ•°æ®å¯¼å‡ºå¤±è´¥ï¼š' + error.message);
            }
        });

        // å¤šè”æœºå†…æœºå¯¼å…¥æ¨¡æ€æ¡†äº‹ä»¶
        document.getElementById('importMultiBtn').addEventListener('click', () => {
            document.getElementById('importModalMulti').classList.remove('hidden');
        });

        document.getElementById('importMultiCancelBtn').addEventListener('click', () => {
            document.getElementById('importModalMulti').classList.add('hidden');
            document.getElementById('importMultiFile2').value = '';
        });

        // ä¸€æ‹–ä¸€å¯¼å…¥æ¨¡æ€æ¡†äº‹ä»¶
        document.getElementById('importOneToOneBtn').addEventListener('click', () => {
            document.getElementById('importModalOneToOne').classList.remove('hidden');
        });

        document.getElementById('importOneToOneCancelBtn').addEventListener('click', () => {
            document.getElementById('importModalOneToOne').classList.add('hidden');
            document.getElementById('importOneToOneFile2').value = '';
        });

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å¯¼å…¥æ¨¡æ€æ¡†äº‹ä»¶
        document.getElementById('importDownstreamBtn').addEventListener('click', () => {
            document.getElementById('importModalDownstream').classList.remove('hidden');
        });

        document.getElementById('importDownstreamCancelBtn').addEventListener('click', () => {
            document.getElementById('importModalDownstream').classList.add('hidden');
            document.getElementById('importDownstreamFile2').value = '';
        });

        // å¤„ç†å•ä¸ªæ–‡ä»¶å¯¼å…¥
        function processImportFile(file) {
            return new Promise((resolve, reject) => {
                if (!file) {
                    resolve({ success: false, message: 'æœªé€‰æ‹©æ–‡ä»¶' });
                    return;
                }

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = new Uint8Array(event.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const sheetName = workbook.SheetNames[0];
                        const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);

                        resolve({ success: true, data: sheetData });
                    } catch (error) {
                        console.error('å¯¼å…¥å¤±è´¥:', error);
                        resolve({ success: false, message: error.message });
                    }
                };
                reader.onerror = () => resolve({ success: false, message: 'æ–‡ä»¶è¯»å–å¤±è´¥' });
                reader.readAsArrayBuffer(file);
            });
        }

        // å¤šè”æœºå†…æœºå¯¼å…¥
        document.getElementById('importMultiSubmitBtn').addEventListener('click', async () => {
            const file = document.getElementById('importMultiFile2').files[0];
            if (!file) {
                alert('è¯·é€‰æ‹©Excelæ–‡ä»¶ï¼');
                return;
            }

            try {
                const result = await processImportFile(file);

                if (result.success && result.data.length > 0) {
                    // æ¸…ç©ºå¤šè”æœºå†…æœºæ•°æ®
                    models.length = 0;
                    pipeSpecs.length = 0;

                    const brandMap = new Map();
                    const modelMap = new Map();
                    let brandIdCounter = Math.max(...brands.map(b => b.id), 0) + 1;

                    result.data.forEach(row => {
                        // å¤„ç†å“ç‰Œ
                        const brandName = row['å“ç‰Œ'] || '';
                        if (brandName && !brandMap.has(brandName)) {
                            const existingBrand = brands.find(b => b.name === brandName);
                            const brandId = existingBrand ? existingBrand.id : brandIdCounter++;
                            if (!existingBrand) {
                                brands.push({ id: brandId, name: brandName });
                            }
                            brandMap.set(brandName, brandId);
                        }

                        const brandId = brandMap.get(brandName);

                        // å¤„ç†å‹å·
                        const capacity = row['è®¾å¤‡å†·é‡'] || row['å‹å·åç§°'] || '';
                        const modelKey = `${brandId}_${capacity}`;

                        if (capacity && !modelMap.has(modelKey)) {
                            const modelId = modelMap.size + 1;
                            modelMap.set(modelKey, modelId);
                            models.push({
                                id: modelId,
                                brandId: brandId,
                                modelName: capacity.toString(),
                                capacity: `${capacity} kW`
                            });

                            // å¤„ç†ç®¡å¾„
                            if (row['æ°”ç®¡']) {
                                pipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'æ°”ç®¡',
                                    pipeSize: row['æ°”ç®¡']
                                });
                            }
                            if (row['æ¶²ç®¡']) {
                                pipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'æ¶²ç®¡',
                                    pipeSize: row['æ¶²ç®¡']
                                });
                            }
                        }
                    });

                    // æ›´æ–°ç•Œé¢
                    initBrandSelect();
                    document.getElementById('importModalMulti').classList.add('hidden');
                    document.getElementById('importMultiFile2').value = '';
                    alert(`å¤šè”æœºå†…æœºæ•°æ®å¯¼å…¥æˆåŠŸï¼\nå…±å¯¼å…¥ ${models.length} æ¡æ•°æ®`);
                } else if (result.success) {
                    alert('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ— æ•°æ®');
                } else {
                    alert('å¯¼å…¥å¤±è´¥ï¼š' + result.message);
                }
            } catch (error) {
                console.error('å¯¼å…¥å¤±è´¥:', error);
                alert('æ•°æ®å¯¼å…¥å¤±è´¥ï¼š' + error.message);
            }
        });

        // ä¸€æ‹–ä¸€å¯¼å…¥
        document.getElementById('importOneToOneSubmitBtn').addEventListener('click', async () => {
            const file = document.getElementById('importOneToOneFile2').files[0];
            if (!file) {
                alert('è¯·é€‰æ‹©Excelæ–‡ä»¶ï¼');
                return;
            }

            try {
                const result = await processImportFile(file);

                if (result.success && result.data.length > 0) {
                    // æ¸…ç©ºä¸€æ‹–ä¸€æ•°æ®
                    oneToOneModels.length = 0;
                    oneToOnePipeSpecs.length = 0;

                    const brandMap = new Map();
                    const modelMap = new Map();
                    let brandIdCounter = Math.max(...brands.map(b => b.id), 0) + 1;

                    result.data.forEach(row => {
                        // å¤„ç†å“ç‰Œ
                        const brandName = row['å“ç‰Œ'] || '';
                        if (brandName && !brandMap.has(brandName)) {
                            const existingBrand = brands.find(b => b.name === brandName);
                            const brandId = existingBrand ? existingBrand.id : brandIdCounter++;
                            if (!existingBrand) {
                                brands.push({ id: brandId, name: brandName });
                            }
                            brandMap.set(brandName, brandId);
                        }

                        const brandId = brandMap.get(brandName);

                        // å¤„ç†å‹å·
                        const capacity = row['è®¾å¤‡å†·é‡'] || row['å‹å·åç§°'] || '';
                        const modelKey = `${brandId}_${capacity}`;

                        if (capacity && !modelMap.has(modelKey)) {
                            const modelId = 1000 + modelMap.size + 1;
                            modelMap.set(modelKey, modelId);
                            oneToOneModels.push({
                                id: modelId,
                                brandId: brandId,
                                modelName: capacity.toString(),
                                capacity: `${capacity} HP`
                            });

                            // å¤„ç†ç®¡å¾„
                            if (row['æ°”ç®¡']) {
                                oneToOnePipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'æ°”ç®¡',
                                    pipeSize: row['æ°”ç®¡']
                                });
                            }
                            if (row['æ¶²ç®¡']) {
                                oneToOnePipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'æ¶²ç®¡',
                                    pipeSize: row['æ¶²ç®¡']
                                });
                            }
                        }
                    });

                    // æ›´æ–°ç•Œé¢
                    initBrandSelect2();
                    document.getElementById('importModalOneToOne').classList.add('hidden');
                    document.getElementById('importOneToOneFile2').value = '';
                    alert(`ä¸€æ‹–ä¸€æ•°æ®å¯¼å…¥æˆåŠŸï¼\nå…±å¯¼å…¥ ${oneToOneModels.length} æ¡æ•°æ®`);
                } else if (result.success) {
                    alert('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ— æ•°æ®');
                } else {
                    alert('å¯¼å…¥å¤±è´¥ï¼š' + result.message);
                }
            } catch (error) {
                console.error('å¯¼å…¥å¤±è´¥:', error);
                alert('æ•°æ®å¯¼å…¥å¤±è´¥ï¼š' + error.message);
            }
        });

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å¯¼å…¥
        document.getElementById('importDownstreamSubmitBtn').addEventListener('click', async () => {
            const file = document.getElementById('importDownstreamFile2').files[0];
            if (!file) {
                alert('è¯·é€‰æ‹©Excelæ–‡ä»¶ï¼');
                return;
            }

            try {
                const result = await processImportFile(file);

                if (result.success && result.data.length > 0) {
                    // æ¸…ç©ºå¤šè”æœºä¸‹æ¸¸ç®¡å¾„æ•°æ®
                    downstreamModels.length = 0;
                    downstreamPipeSpecs.length = 0;

                    const brandMap = new Map();
                    const modelMap = new Map();
                    let brandIdCounter = Math.max(...brands.map(b => b.id), 0) + 1;

                    result.data.forEach(row => {
                        // å¤„ç†å“ç‰Œ
                        const brandName = row['å“ç‰Œ'] || '';
                        if (brandName && !brandMap.has(brandName)) {
                            const existingBrand = brands.find(b => b.name === brandName);
                            const brandId = existingBrand ? existingBrand.id : brandIdCounter++;
                            if (!existingBrand) {
                                brands.push({ id: brandId, name: brandName });
                            }
                            brandMap.set(brandName, brandId);
                        }

                        const brandId = brandMap.get(brandName);

                        // å¤„ç†å‹å·
                        const capacity = row['è®¾å¤‡å†·é‡'] || row['å‹å·åç§°'] || '';
                        const modelKey = `${brandId}_${capacity}`;

                        if (capacity && !modelMap.has(modelKey)) {
                            const modelId = modelMap.size + 1;
                            modelMap.set(modelKey, modelId);
                            downstreamModels.push({
                                id: modelId,
                                brandId: brandId,
                                modelName: capacity.toString(),
                                capacity: `${capacity} kW`
                            });

                            // å¤„ç†ç®¡å¾„ï¼ˆå«åˆ†æ­§ç®¡ï¼‰
                            if (row['æ°”ç®¡']) {
                                downstreamPipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'æ°”ç®¡',
                                    pipeSize: row['æ°”ç®¡']
                                });
                            }
                            if (row['æ¶²ç®¡']) {
                                downstreamPipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'æ¶²ç®¡',
                                    pipeSize: row['æ¶²ç®¡']
                                });
                            }
                            if (row['åˆ†æ­§ç®¡']) {
                                downstreamPipeSpecs.push({
                                    modelId: modelId,
                                    pipeType: 'åˆ†æ­§ç®¡',
                                    pipeSize: row['åˆ†æ­§ç®¡']
                                });
                            }
                        }
                    });

                    // æ›´æ–°ç•Œé¢
                    initBrandSelect3();
                    document.getElementById('importModalDownstream').classList.add('hidden');
                    document.getElementById('importDownstreamFile2').value = '';
                    alert(`å¤šè”æœºä¸‹æ¸¸ç®¡å¾„æ•°æ®å¯¼å…¥æˆåŠŸï¼\nå…±å¯¼å…¥ ${downstreamModels.length} æ¡æ•°æ®`);
                } else if (result.success) {
                    alert('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ— æ•°æ®');
                } else {
                    alert('å¯¼å…¥å¤±è´¥ï¼š' + result.message);
                }
            } catch (error) {
                console.error('å¯¼å…¥å¤±è´¥:', error);
                alert('æ•°æ®å¯¼å…¥å¤±è´¥ï¼š' + error.message);
            }
        });


        // æ ‡ç­¾é¡µDOMå…ƒç´ 
        const tabMulti = document.getElementById('tabMulti');
        const tabDownstream = document.getElementById('tabDownstream');
        const tabOneToOne = document.getElementById('tabOneToOne');
        const multiPage = document.getElementById('multiPage');
        const downstreamPage = document.getElementById('downstreamPage');
        const oneToOnePage = document.getElementById('oneToOnePage');

        // æ ‡ç­¾é¡µåˆ‡æ¢é€»è¾‘
        function switchTab(tab) {
            // é‡ç½®æ‰€æœ‰æ ‡ç­¾é¡µæ ·å¼
            [tabMulti, tabDownstream, tabOneToOne].forEach(t => {
                t.classList.remove('border-blue-500', 'text-blue-600', 'bg-blue-50');
                t.classList.remove('border-purple-500', 'text-purple-600', 'bg-purple-50');
                t.classList.remove('border-green-500', 'text-green-600', 'bg-green-50');
                t.classList.add('border-transparent', 'text-gray-600');
            });

            // éšè—æ‰€æœ‰é¡µé¢
            multiPage.classList.add('hidden');
            downstreamPage.classList.add('hidden');
            oneToOnePage.classList.add('hidden');

            if (tab === 'multi') {
                // åˆ‡æ¢åˆ°å¤šè”æœºå†…æœºæ ‡ç­¾é¡µ
                tabMulti.classList.add('border-blue-500', 'text-blue-600', 'bg-blue-50');
                tabMulti.classList.remove('border-transparent', 'text-gray-600');
                multiPage.classList.remove('hidden');
            } else if (tab === 'downstream') {
                // åˆ‡æ¢åˆ°å¤šè”æœºä¸‹æ¸¸ç®¡å¾„æ ‡ç­¾é¡µ
                tabDownstream.classList.add('border-purple-500', 'text-purple-600', 'bg-purple-50');
                tabDownstream.classList.remove('border-transparent', 'text-gray-600');
                downstreamPage.classList.remove('hidden');
                // åˆå§‹åŒ–å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å“ç‰Œé€‰æ‹©å™¨ï¼ˆå¦‚æœè¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼‰
                if (brandSelect3.options.length === 1) {
                    initBrandSelect3();
                }
            } else if (tab === 'oneToOne') {
                // åˆ‡æ¢åˆ°ä¸€æ‹–ä¸€æ ‡ç­¾é¡µ
                tabOneToOne.classList.add('border-green-500', 'text-green-600', 'bg-green-50');
                tabOneToOne.classList.remove('border-transparent', 'text-gray-600');
                oneToOnePage.classList.remove('hidden');
                // åˆå§‹åŒ–ä¸€æ‹–ä¸€å“ç‰Œé€‰æ‹©å™¨ï¼ˆå¦‚æœè¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼‰
                if (brandSelect2.options.length === 1) {
                    initBrandSelect2();
                }
            }
        }

        tabMulti.addEventListener('click', () => switchTab('multi'));
        tabDownstream.addEventListener('click', () => switchTab('downstream'));
        tabOneToOne.addEventListener('click', () => switchTab('oneToOne'));

        // åˆå§‹åŒ–å“ç‰Œé€‰æ‹©å™¨
        function initBrandSelect() {
            try {
                console.log('=== åˆå§‹åŒ–å¤šè”æœºå†…æœºå“ç‰Œé€‰æ‹©å™¨ ===');
                console.log('brandSelect å…ƒç´ :', brandSelect);
                console.log('å“ç‰Œæ•°é‡:', brands.length);

                // å…ˆæ¸…ç©ºå†æ·»åŠ 
                brandSelect.innerHTML = '<option value="">è¯·é€‰æ‹©å“ç‰Œ</option>';
                const sortedBrands = [...brands].sort((a, b) => a.name.localeCompare(b.name, 'zh-CN'));
                console.log('æ’åºåçš„å“ç‰Œ:', sortedBrands.map(b => b.name));
                sortedBrands.forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand.id;
                    option.textContent = brand.name;
                    brandSelect.appendChild(option);
                });
                console.log('åˆå§‹åŒ–åé€‰é¡¹æ•°:', brandSelect.options.length);
            } catch (error) {
                console.error('initBrandSelect é”™è¯¯:', error);
            }
        }

        // å¤„ç†å“ç‰Œé€‰æ‹©
        brandSelect.addEventListener('change', function() {
            const brandId = parseInt(this.value);
            console.log('=== å¤šè”æœºå†…æœºå“ç‰Œé€‰æ‹© ===');
            console.log('é€‰æ‹©çš„å“ç‰ŒID:', brandId);
            console.log('brandSelect.value:', this.value);
            console.log('brandIdç±»å‹:', typeof brandId, 'å€¼:', brandId);

            // æ¸…ç©ºå‹å·é€‰æ‹©
            modelSelect.innerHTML = '<option value="">è¯·é€‰æ‹©å†·é‡</option>';
            modelSelect.disabled = !brandId;

            // éšè—ç»“æœ
            resultContainer.classList.add('hidden');
            noDataMessage.classList.add('hidden');

            if (brandId) {
                console.log('å¼€å§‹æŸ¥æ‰¾å“ç‰ŒIDä¸º', brandId, 'çš„å‹å·');
                console.log('modelsæ•°ç»„é•¿åº¦:', models.length);
                console.log('modelså‰3ä¸ªç¤ºä¾‹:', models.slice(0, 3).map(m => ({id: m.id, brandId: m.brandId, name: m.modelName})));

                // åŠ è½½è¯¥å“ç‰Œçš„å‹å·
                const brandModels = models.filter(m => m.brandId === brandId);
                console.log('è¿‡æ»¤åçš„å‹å·æ•°é‡:', brandModels.length);
                console.log('è¿‡æ»¤åçš„å‹å·:', brandModels.map(m => ({id: m.id, brandId: m.brandId, name: m.modelName})));

                // æ’åº
                brandModels.sort((a, b) => parseFloat(a.modelName) - parseFloat(b.modelName));
                console.log('æ’åºåå‹å·æ•°é‡:', brandModels.length);
                console.log('å‹å·åˆ—è¡¨:', brandModels.map(m => m.modelName));

                brandModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.id;
                    option.textContent = model.modelName;
                    modelSelect.appendChild(option);
                });

                console.log('æ·»åŠ åçš„modelSelecté€‰é¡¹æ•°:', modelSelect.options.length);
                console.log('modelSelect.disabled:', modelSelect.disabled);
            }
        });

        // å¤„ç†å‹å·é€‰æ‹©
        modelSelect.addEventListener('change', function() {
            const modelId = parseInt(this.value);
            
            if (modelId) {
                displayPipeSpecs(modelId);
            } else {
                resultContainer.classList.add('hidden');
                noDataMessage.classList.add('hidden');
            }
        });

        // æ˜¾ç¤ºç®¡å¾„è§„æ ¼
        function displayPipeSpecs(modelId) {
            const specs = pipeSpecs.filter(ps => ps.modelId === modelId);
            
            if (specs.length > 0) {
                pipeSpecsContainer.innerHTML = specs.map(spec => `
                    <div class="bg-white rounded-lg shadow-md p-5 border-l-4 ${spec.pipeType === 'æ°”ç®¡' ? 'border-blue-500' : 'border-green-500'} hover:shadow-xl transition-shadow">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ${spec.pipeType === 'æ°”ç®¡' ? 'bg-blue-100 text-blue-600' : 'bg-green-100 text-green-600'}">
                                ${spec.pipeType === 'æ°”ç®¡' ? 'ğŸ”µ' : 'ğŸŸ¢'}
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 font-medium">ç®¡è·¯ç±»å‹</div>
                                <div class="text-lg font-bold text-gray-800">${spec.pipeType}</div>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <div class="text-sm text-gray-500 font-medium mb-1">ç®¡å¾„è§„æ ¼</div>
                            <div class="text-3xl font-extrabold text-blue-600">${spec.pipeSize}</div>
                        </div>
                    </div>
                `).join('');
                
                // æ›´æ–°è®¾å¤‡ä¿¡æ¯å’Œå†·é‡ä¿¡æ¯
                const model = models.find(m => m.id === modelId);
                const brand = brands.find(b => b.id === model.brandId);
                const deviceInfoEl = document.getElementById('deviceInfo');
                const capacityInfoEl = document.getElementById('capacityInfo');
                
                if (deviceInfoEl && capacityInfoEl && model && brand) {
                    deviceInfoEl.textContent = `${brand.name}`;
                    capacityInfoEl.textContent = `è®¾å¤‡å†·é‡ï¼š${model.modelName} kW`;
                }
                
                resultContainer.classList.remove('hidden');
                noDataMessage.classList.add('hidden');
            } else {
                resultContainer.classList.add('hidden');
                noDataMessage.classList.remove('hidden');
            }
        }

        // ä¸€æ‹–ä¸€é¡µé¢ï¼šåˆå§‹åŒ–å“ç‰Œé€‰æ‹©å™¨
        function initBrandSelect2() {
            try {
                console.log('=== åˆå§‹åŒ–ä¸€æ‹–ä¸€å“ç‰Œé€‰æ‹©å™¨ ===');
                console.log('brandSelect2 å…ƒç´ :', brandSelect2);
                console.log('å“ç‰Œæ•°é‡:', brands.length);
                const sortedBrands = [...brands].sort((a, b) => a.name.localeCompare(b.name, 'zh-CN'));
                console.log('æ’åºåçš„å“ç‰Œ:', sortedBrands.map(b => b.name));
                sortedBrands.forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand.id;
                    option.textContent = brand.name;
                    brandSelect2.appendChild(option);
                });
                console.log('åˆå§‹åŒ–åé€‰é¡¹æ•°:', brandSelect2.options.length);
            } catch (error) {
                console.error('initBrandSelect2 é”™è¯¯:', error);
            }
        }

        // ä¸€æ‹–ä¸€é¡µé¢ï¼šå¤„ç†å“ç‰Œé€‰æ‹©
        brandSelect2.addEventListener('change', function() {
            const brandId = parseInt(this.value);
            console.log('=== ä¸€æ‹–ä¸€é¡µé¢å“ç‰Œé€‰æ‹© ===');
            console.log('é€‰æ‹©çš„å“ç‰ŒID:', brandId);
            console.log('ä½¿ç”¨ä¸€æ‹–ä¸€ç‹¬ç«‹æ•°æ®æº oneToOneModels');

            // æ¸…ç©ºå‹å·é€‰æ‹©
            modelSelect2.innerHTML = '<option value="">è¯·é€‰æ‹©å†·é‡</option>';
            modelSelect2.disabled = !brandId;

            // éšè—ç»“æœ
            resultContainer2.classList.add('hidden');
            noDataMessage2.classList.add('hidden');

            if (brandId) {
                // åŠ è½½è¯¥å“ç‰Œçš„å‹å·ï¼ˆä½¿ç”¨ä¸€æ‹–ä¸€ç‹¬ç«‹æ•°æ®ï¼‰
                const brandModels = oneToOneModels.filter(m => m.brandId === brandId)
                    .sort((a, b) => parseFloat(a.modelName) - parseFloat(b.modelName));
                console.log('æ‰¾åˆ°çš„å‹å·æ•°é‡:', brandModels.length);
                console.log('å‹å·åˆ—è¡¨:', brandModels.map(m => m.modelName));

                brandModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.id;
                    option.textContent = model.modelName;
                    modelSelect2.appendChild(option);
                });
            }
        });

        // ä¸€æ‹–ä¸€é¡µé¢ï¼šå¤„ç†å‹å·é€‰æ‹©
        modelSelect2.addEventListener('change', function() {
            const modelId = parseInt(this.value);

            if (modelId) {
                displayPipeSpecs2(modelId);
            } else {
                resultContainer2.classList.add('hidden');
                noDataMessage2.classList.add('hidden');
            }
        });

        // ä¸€æ‹–ä¸€é¡µé¢ï¼šæ˜¾ç¤ºç®¡å¾„è§„æ ¼
        function displayPipeSpecs2(modelId) {
            console.log('=== ä¸€æ‹–ä¸€é¡µé¢æ˜¾ç¤ºç®¡å¾„ ===');
            console.log('modelId:', modelId);
            console.log('ä½¿ç”¨ä¸€æ‹–ä¸€ç‹¬ç«‹æ•°æ®æº oneToOnePipeSpecs');

            const specs = oneToOnePipeSpecs.filter(ps => ps.modelId === modelId);
            console.log('æ‰¾åˆ°çš„ç®¡å¾„è§„æ ¼æ•°é‡:', specs.length);

            if (specs.length > 0) {
                pipeSpecsContainer2.innerHTML = specs.map(spec => `
                    <div class="bg-white rounded-lg shadow-md p-5 border-l-4 ${spec.pipeType === 'æ°”ç®¡' ? 'border-green-500' : 'border-emerald-500'} hover:shadow-xl transition-shadow">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ${spec.pipeType === 'æ°”ç®¡' ? 'bg-green-100 text-green-600' : 'bg-emerald-100 text-emerald-600'}">
                                ${spec.pipeType === 'æ°”ç®¡' ? 'ğŸ”µ' : 'ğŸŸ¢'}
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 font-medium">ç®¡è·¯ç±»å‹</div>
                                <div class="text-lg font-bold text-gray-800">${spec.pipeType}</div>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <div class="text-sm text-gray-500 font-medium mb-1">ç®¡å¾„è§„æ ¼</div>
                            <div class="text-3xl font-extrabold text-green-600">${spec.pipeSize}</div>
                        </div>
                    </div>
                `).join('');

                // æ›´æ–°è®¾å¤‡ä¿¡æ¯å’Œå†·é‡ä¿¡æ¯
                const model = oneToOneModels.find(m => m.id === modelId);
                const brand = brands.find(b => b.id === model.brandId);
                const deviceInfoEl2 = document.getElementById('deviceInfo2');
                const capacityInfoEl2 = document.getElementById('capacityInfo2');

                if (deviceInfoEl2 && capacityInfoEl2 && model && brand) {
                    deviceInfoEl2.textContent = `${brand.name}`;
                    capacityInfoEl2.textContent = `è®¾å¤‡å†·é‡ï¼š${model.modelName} kW`;
                }

                resultContainer2.classList.remove('hidden');
                noDataMessage2.classList.add('hidden');
            } else {
                resultContainer2.classList.add('hidden');
                noDataMessage2.classList.remove('hidden');
            }
        }

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ï¼šåˆå§‹åŒ–å“ç‰Œé€‰æ‹©å™¨
        function initBrandSelect3() {
            try {
                console.log('=== åˆå§‹åŒ–å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å“ç‰Œé€‰æ‹©å™¨ ===');
                console.log('brandSelect3 å…ƒç´ :', brandSelect3);
                console.log('å“ç‰Œæ•°é‡:', brands.length);
                const sortedBrands = [...brands].sort((a, b) => a.name.localeCompare(b.name, 'zh-CN'));
                console.log('æ’åºåçš„å“ç‰Œ:', sortedBrands.map(b => b.name));
                sortedBrands.forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand.id;
                    option.textContent = brand.name;
                    brandSelect3.appendChild(option);
                });
                console.log('åˆå§‹åŒ–åé€‰é¡¹æ•°:', brandSelect3.options.length);
            } catch (error) {
                console.error('initBrandSelect3 é”™è¯¯:', error);
            }
        }

        // ç”Ÿæˆå®¤å†…æœºè¾“å…¥æ¡†
        // å®¤å†…æœºæ•°é‡
        let indoorUnitCount = 2;

        // åˆ›å»ºæŒ‰é’®HTML
        function createButtonsHtml() {
            return `
                <div class="flex gap-2 mt-2">
                    <button onclick="addIndoorUnit()" class="flex-1 px-2 py-1 bg-purple-600 text-white text-xs rounded hover:bg-purple-700 transition">
                        + æ·»åŠ 
                    </button>
                    <button onclick="removeIndoorUnit()" class="flex-1 px-2 py-1 bg-orange-600 text-white text-xs rounded hover:bg-orange-700 transition">
                        - åˆ é™¤
                    </button>
                </div>
            `;
        }

        // æ›´æ–°æŒ‰é’®ä½ç½®ï¼ˆç§»åˆ°æœ€åä¸€ä¸ªè¾“å…¥æ¡†åé¢ï¼‰
        function updateButtonPosition() {
            // ç§»é™¤æ‰€æœ‰ç°æœ‰çš„æŒ‰é’®
            const existingButtons = indoorUnitsContainer.querySelectorAll('.unit-buttons');
            existingButtons.forEach(btn => btn.remove());

            // åœ¨æœ€åä¸€ä¸ªè¾“å…¥æ¡†åé¢æ·»åŠ æŒ‰é’®
            const lastInputDiv = indoorUnitsContainer.lastElementChild;
            if (lastInputDiv) {
                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'unit-buttons';
                buttonsDiv.innerHTML = createButtonsHtml();
                lastInputDiv.appendChild(buttonsDiv);
            }
        }

        function generateIndoorUnitInputs() {
            console.log('=== ç”Ÿæˆå®¤å†…æœºè¾“å…¥æ¡† ===');
            indoorUnitsContainer.innerHTML = '';

            for (let i = 1; i <= indoorUnitCount; i++) {
                const div = document.createElement('div');
                div.className = i === indoorUnitCount ? 'border-b border-purple-300 pb-2' : '';
                div.innerHTML = `
                    <label class="block text-xs font-medium text-gray-600 mb-1">å®¤å†…æœº ${i}</label>
                    <input type="number" id="indoorUnit${i}" step="0.1" min="0"
                        class="w-full px-2 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"
                        placeholder="kW">
                `;
                indoorUnitsContainer.appendChild(div);

                // ç»™æ¯ä¸ªè¾“å…¥æ¡†æ·»åŠ inputäº‹ä»¶ç›‘å¬å™¨
                const input = div.querySelector('input');
                input.addEventListener('input', autoCalculateTotalCapacity);
            }

            // åœ¨æœ€åä¸€ä¸ªè¾“å…¥æ¡†åé¢æ·»åŠ æŒ‰é’®
            updateButtonPosition();

            console.log('å·²ç”Ÿæˆ', indoorUnitCount, 'ä¸ªå®¤å†…æœºè¾“å…¥æ¡†');
        }

        // æ·»åŠ å®¤å†…æœºï¼ˆè¿½åŠ æ¨¡å¼ï¼‰
        window.addIndoorUnit = function() {
            if (indoorUnitCount >= 40) {
                alert('æœ€å¤šæ”¯æŒ40å°å®¤å†…æœº');
                return;
            }
            indoorUnitCount++;

            // å…ˆç§»é™¤æ—§æŒ‰é’®
            const existingButtons = indoorUnitsContainer.querySelectorAll('.unit-buttons');
            existingButtons.forEach(btn => btn.remove());

            // åˆ›å»ºæ–°çš„è¾“å…¥æ¡†å¹¶è¿½åŠ åˆ°å®¹å™¨æœ«å°¾
            const div = document.createElement('div');
            div.innerHTML = `
                <label class="block text-xs font-medium text-gray-600 mb-1">å®¤å†…æœº ${indoorUnitCount}</label>
                <input type="number" id="indoorUnit${indoorUnitCount}" step="0.1" min="0"
                    class="w-full px-2 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"
                    placeholder="kW">
            `;
            indoorUnitsContainer.appendChild(div);

            // ç»™æ–°æ·»åŠ çš„è¾“å…¥æ¡†æ·»åŠ inputäº‹ä»¶ç›‘å¬å™¨
            const input = div.querySelector('input');
            input.addEventListener('input', autoCalculateTotalCapacity);

            // åœ¨æ–°æ·»åŠ çš„è¾“å…¥æ¡†åé¢æ·»åŠ æŒ‰é’®
            updateButtonPosition();

            // è‡ªåŠ¨æ»šåŠ¨åˆ°æ–°æ·»åŠ çš„å…ƒç´ 
            const scrollContainer = document.getElementById('indoorUnitsScrollContainer');
            if (scrollContainer) {
                setTimeout(() => {
                    scrollContainer.scrollTop = scrollContainer.scrollHeight;
                }, 100);
            }

            console.log('å·²æ·»åŠ ç¬¬', indoorUnitCount, 'å°å®¤å†…æœº');
        };

        // åˆ é™¤å®¤å†…æœºï¼ˆåˆ é™¤æœ€åä¸€ä¸ªï¼‰
        window.removeIndoorUnit = function() {
            if (indoorUnitCount <= 1) {
                alert('è‡³å°‘ä¿ç•™1å°å®¤å†…æœº');
                return;
            }

            // è·å–æœ€åä¸€ä¸ªè¾“å…¥æ¡†çš„å€¼å¹¶æç¤º
            const lastInput = document.getElementById(`indoorUnit${indoorUnitCount}`);
            if (lastInput && lastInput.value) {
                if (!confirm('æœ€åä¸€å°å®¤å†…æœºæœ‰è¾“å…¥å€¼ï¼Œç¡®å®šè¦åˆ é™¤å—ï¼Ÿ')) {
                    return;
                }
            }

            // åˆ é™¤å®¹å™¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ 
            if (indoorUnitsContainer.lastElementChild) {
                indoorUnitsContainer.removeChild(indoorUnitsContainer.lastElementChild);
            }

            indoorUnitCount--;

            // åˆ é™¤åæ›´æ–°æŒ‰é’®ä½ç½®åˆ°æ–°çš„æœ€åä¸€ä¸ªè¾“å…¥æ¡†åé¢
            updateButtonPosition();

            // åˆ é™¤åæ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆå¦‚æœè¿˜æœ‰å†…å®¹ï¼‰
            if (indoorUnitsScrollContainer) {
                setTimeout(() => {
                    indoorUnitsScrollContainer.scrollTop = indoorUnitsScrollContainer.scrollHeight;
                }, 100);
            }

            console.log('å·²åˆ é™¤ï¼Œå½“å‰å®¤å†…æœºæ•°é‡:', indoorUnitCount);
        };

        // è‡ªåŠ¨è®¡ç®—æ€»å†·é‡ï¼ˆä¸å¼¹å‡ºæç¤ºï¼‰
        function autoCalculateTotalCapacity() {
            const brandId = parseInt(brandSelect3.value);
            if (!brandId) {
                return;
            }

            let total = 0;
            let hasInput = false;

            // éå†æ‰€æœ‰å®¤å†…æœºè¾“å…¥æ¡†
            const inputs = indoorUnitsContainer.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                const value = parseFloat(input.value);
                if (!isNaN(value) && value > 0) {
                    total += value;
                    hasInput = true;
                }
            });

            if (!hasInput) {
                totalCapacity3.value = '0';
                resultContainer3.classList.add('hidden');
                noDataMessage3.classList.add('hidden');
                return;
            }

            totalCapacity3.value = total.toFixed(2);

            console.log('=== è‡ªåŠ¨è®¡ç®—æ€»å†·é‡ ===');
            console.log('æ€»å†·é‡:', total.toFixed(2), 'kW');

            // æ ¹æ®æ€»å†·é‡å’Œå“ç‰Œè‡ªåŠ¨åŒ¹é…ç®¡å¾„è§„æ ¼
            matchAndDisplayPipeSpecs(total, brandId);
        }

        // è®¡ç®—æ€»å†·é‡ï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰
        function calculateTotalCapacity() {
            const brandId = parseInt(brandSelect3.value);
            if (!brandId) {
                alert('è¯·å…ˆé€‰æ‹©å“ç‰Œ');
                return;
            }

            autoCalculateTotalCapacity();
        }

        // æ¸…ç©ºæ‰€æœ‰å®¤å†…æœºè¾“å…¥
        function clearAllIndoorUnits() {
            const inputs = indoorUnitsContainer.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.value = '';
            });
            totalCapacity3.value = '0';
            resultContainer3.classList.add('hidden');
            noDataMessage3.classList.add('hidden');

            console.log('å·²æ¸…ç©ºæ‰€æœ‰å®¤å†…æœºè¾“å…¥');
        }

        // è§£æå®¹é‡åŒºé—´ï¼Œè¿”å›æœ€å°å’Œæœ€å¤§å€¼
        function parseCapacityRange(rangeStr) {
            // å¤„ç†å„ç§æ ¼å¼çš„å®¹é‡åŒºé—´å­—ç¬¦ä¸²
            // ç¤ºä¾‹: "Aâ‰¤16.8", "16.8â‰¤A<22.4", "A<16", "22.4â‰¤A", "16â‰¤A<25", "70æœªæ»¡", "7.0æœªæ»¡", "186.0ä»¥ä¸Š~220.5"
            // å¤§é‡‘æ ¼å¼: "ï¼œ16.8KW", "16.8â‰¤Xï¼œ22.4KW", "22.4â‰¤Xï¼œ33.0KW", "33.0â‰¤Xï¼œ47.0KW"
            console.log('è§£æå®¹é‡åŒºé—´:', rangeStr);

            let min, max;

            // æå–æ‰€æœ‰æ•°å­—
            const numbers = rangeStr.match(/(\d+\.?\d*)/g);
            if (!numbers || numbers.length === 0) {
                console.log('æœªæ‰¾åˆ°æ•°å­—');
                return { min: Infinity, max: Infinity };
            }

            const numValues = numbers.map(n => parseFloat(n));

            if (rangeStr.includes('æœªæ»¡')) {
                // æ ¼å¼: "70æœªæ»¡" æˆ– "7.0æœªæ»¡"
                min = 0;
                max = numValues[0];
            } else if (rangeStr.includes('ä»¥ä¸Š')) {
                // æ ¼å¼: "1100ä»¥ä¸Š~1560æœªæ»¡" æˆ– "186.0ä»¥ä¸Š~220.5"
                min = numValues[0];
                if (rangeStr.includes('æœªæ»¡')) {
                    max = numValues[1];
                } else {
                    max = Infinity;
                }
            } else if (rangeStr.includes('â‰¤') || rangeStr.includes('<') || rangeStr.includes('ï¼œ')) {
                // æ ¼å¼: "Aâ‰¤16.8", "16.8â‰¤A<22.4", "A<16", "16â‰¤A<25", "22.4â‰¤A"
                // å¤§é‡‘æ ¼å¼: "ï¼œ16.8KW", "16.8â‰¤Xï¼œ22.4KW"
                if (rangeStr.startsWith('Aâ‰¤') || rangeStr.startsWith('ï¼œ')) {
                    // Aâ‰¤16.8 æˆ– ï¼œ16.8KW
                    min = 0;
                    max = numValues[0];
                } else if (rangeStr.startsWith('A<')) {
                    // A<16
                    min = 0;
                    max = numValues[0];
                } else if (rangeStr.includes('â‰¤A<') || rangeStr.includes('â‰¤Xï¼œ') || rangeStr.includes('â‰¤X<')) {
                    // 16.8â‰¤A<22.4 æˆ– 16â‰¤A<25 æˆ– 16.8â‰¤Xï¼œ22.4KW
                    min = numValues[0];
                    max = numValues[1];
                } else if (rangeStr.endsWith('â‰¤A')) {
                    // 22.4â‰¤A
                    min = numValues[0];
                    max = Infinity;
                }
            } else {
                // å…¶ä»–æƒ…å†µï¼Œå‡è®¾æ˜¯ä¸€ä¸ªèŒƒå›´æˆ–å•ä¸ªå€¼
                min = numValues[0];
                max = numValues.length > 1 ? numValues[1] : numValues[0];
            }

            console.log('è§£æç»“æœ:', { min, max });
            return { min, max };
        }

        // æ ¹æ®æ€»å†·é‡åŒ¹é…å®¹é‡åŒºé—´
        function matchCapacityRange(totalCapacity, brandId) {
            console.log('=== åŒ¹é…å®¹é‡åŒºé—´ ===');
            console.log('æ€»å†·é‡:', totalCapacity, 'kW');
            console.log('å“ç‰ŒID:', brandId);

            const brandModels = downstreamModels.filter(m => m.brandId === brandId);
            console.log('è¯¥å“ç‰Œçš„å®¹é‡åŒºé—´æ•°é‡:', brandModels.length);

            let matchedModel = null;

            for (const model of brandModels) {
                const { min, max } = parseCapacityRange(model.modelName);

                // æ£€æŸ¥æ€»å†·é‡æ˜¯å¦åœ¨è¯¥èŒƒå›´å†…
                // æ³¨æ„ï¼šåŒºé—´å®šä¹‰ä¸­çš„å€¼å¯èƒ½æ˜¯ä¸´ç•Œç‚¹ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
                // è¿™é‡Œå‡è®¾åŒºé—´åŒ…å«ä¸‹é™ï¼Œä¸åŒ…å«ä¸Šé™ï¼ˆé™¤äº†æœ€åä¸€ä¸ªåŒºé—´ï¼‰
                if (totalCapacity >= min && totalCapacity < max) {
                    matchedModel = model;
                    break;
                }

                // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœæ€»å†·é‡ç­‰äºmaxä¸”æ˜¯æœ€åä¸€ä¸ªåŒºé—´ï¼Œä¹ŸåŒ¹é…
                if (max === Infinity && totalCapacity >= min) {
                    matchedModel = model;
                    break;
                }
            }

            if (matchedModel) {
                console.log('åŒ¹é…åˆ°çš„å®¹é‡åŒºé—´:', matchedModel.modelName);
                console.log('Model ID:', matchedModel.id);
                return matchedModel;
            } else {
                console.log('æœªæ‰¾åˆ°åŒ¹é…çš„å®¹é‡åŒºé—´');
                return null;
            }
        }

        // åŒ¹é…å¹¶æ˜¾ç¤ºç®¡å¾„è§„æ ¼
        function matchAndDisplayPipeSpecs(totalCapacity, brandId) {
            const matchedModel = matchCapacityRange(totalCapacity, brandId);

            if (matchedModel) {
                displayPipeSpecs3ByCapacity(matchedModel, totalCapacity, brandId);
            } else {
                resultContainer3.classList.add('hidden');
                noDataMessage3.classList.remove('hidden');
                noDataMessage3.textContent = `æœªæ‰¾åˆ°åŒ¹é…æ€»å†·é‡ ${totalCapacity.toFixed(2)} kW çš„å®¹é‡åŒºé—´`;
            }
        }

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ï¼šå¤„ç†å“ç‰Œé€‰æ‹©
        brandSelect3.addEventListener('change', function() {
            const brandId = parseInt(this.value);
            console.log('=== å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢å“ç‰Œé€‰æ‹© ===');
            console.log('é€‰æ‹©çš„å“ç‰ŒID:', brandId);

            // æ¸…ç©ºæ‰€æœ‰è¾“å…¥å’Œç»“æœ
            clearAllIndoorUnits();
        });

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ï¼šæ¸…ç©ºæŒ‰é’®äº‹ä»¶
        clearAllBtn3.addEventListener('click', clearAllIndoorUnits);

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ï¼šæ˜¾ç¤ºç®¡å¾„è§„æ ¼ï¼ˆæ ¹æ®è®¡ç®—çš„æ€»å†·é‡ï¼‰
        function displayPipeSpecs3ByCapacity(matchedModel, totalCapacity, brandId) {
            console.log('=== å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢æ˜¾ç¤ºç®¡å¾„ï¼ˆæ ¹æ®è®¡ç®—ç»“æœï¼‰ ===');
            console.log('åŒ¹é…çš„å®¹é‡åŒºé—´:', matchedModel.modelName);
            console.log('æ€»å†·é‡:', totalCapacity.toFixed(2), 'kW');
            console.log('å“ç‰ŒID:', brandId);
            console.log('Model ID:', matchedModel.id);

            const specs = downstreamPipeSpecs.filter(ps => ps.modelId === matchedModel.id);
            console.log('æ‰¾åˆ°çš„ç®¡å¾„è§„æ ¼æ•°é‡:', specs.length);

            if (specs.length > 0) {
                pipeSpecsContainer3.innerHTML = specs.map(spec => {
                    // æ ¹æ®ç®¡è·¯ç±»å‹è®¾ç½®ä¸åŒçš„é¢œè‰²
                    let borderClass, bgClass, textClass, icon;
                    if (spec.pipeType === 'æ°”ç®¡') {
                        borderClass = 'border-purple-500';
                        bgClass = 'bg-purple-100 text-purple-600';
                        textClass = 'text-purple-600';
                        icon = 'ğŸ”µ';
                    } else if (spec.pipeType === 'æ¶²ç®¡') {
                        borderClass = 'border-pink-500';
                        bgClass = 'bg-pink-100 text-pink-600';
                        textClass = 'text-pink-600';
                        icon = 'ğŸŸ¢';
                    } else {
                        borderClass = 'border-orange-500';
                        bgClass = 'bg-orange-100 text-orange-600';
                        textClass = 'text-orange-600';
                        icon = 'ğŸŸ ';
                    }

                    return `
                    <div class="bg-white rounded-lg shadow-md p-5 border-l-4 ${borderClass} hover:shadow-xl transition-shadow">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ${bgClass}">
                                ${icon}
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 font-medium">ç®¡è·¯ç±»å‹</div>
                                <div class="text-lg font-bold text-gray-800">${spec.pipeType}</div>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <div class="text-sm text-gray-500 font-medium mb-1">è§„æ ¼</div>
                            <div class="text-3xl font-extrabold ${textClass}">${spec.pipeSize}</div>
                        </div>
                    </div>
                `}).join('');

                // æ›´æ–°è®¾å¤‡ä¿¡æ¯å’Œå†·é‡ä¿¡æ¯
                const brand = brands.find(b => b.id === brandId);
                const deviceInfoEl3 = document.getElementById('deviceInfo3');
                const capacityInfoEl3 = document.getElementById('capacityInfo3');

                if (deviceInfoEl3 && capacityInfoEl3 && brand) {
                    deviceInfoEl3.textContent = `${brand.name}`;
                    capacityInfoEl3.textContent = `æ€»å†·é‡ï¼š${totalCapacity.toFixed(2)} kWï¼ˆåŒºé—´ï¼š${matchedModel.modelName}ï¼‰`;
                }

                resultContainer3.classList.remove('hidden');
                noDataMessage3.classList.add('hidden');
            } else {
                resultContainer3.classList.add('hidden');
                noDataMessage3.classList.remove('hidden');
                noDataMessage3.textContent = `æœªæ‰¾åˆ°å®¹é‡åŒºé—´ ${matchedModel.modelName} çš„ç®¡å¾„è§„æ ¼æ•°æ®`;
            }
        }

        // å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢ï¼šæ˜¾ç¤ºç®¡å¾„è§„æ ¼ï¼ˆä¿ç•™åŸå‡½æ•°ç”¨äºå…¶ä»–ç”¨é€”ï¼‰
        function displayPipeSpecs3(modelId) {
            console.log('=== å¤šè”æœºä¸‹æ¸¸ç®¡å¾„é¡µé¢æ˜¾ç¤ºç®¡å¾„ ===');
            console.log('modelId:', modelId);
            console.log('ä½¿ç”¨å¤šè”æœºä¸‹æ¸¸ç®¡å¾„ç‹¬ç«‹æ•°æ®æº downstreamPipeSpecs');

            const specs = downstreamPipeSpecs.filter(ps => ps.modelId === modelId);
            console.log('æ‰¾åˆ°çš„ç®¡å¾„è§„æ ¼æ•°é‡:', specs.length);

            if (specs.length > 0) {
                pipeSpecsContainer3.innerHTML = specs.map(spec => {
                    // æ ¹æ®ç®¡è·¯ç±»å‹è®¾ç½®ä¸åŒçš„é¢œè‰²
                    let borderClass, bgClass, textClass, icon;
                    if (spec.pipeType === 'æ°”ç®¡') {
                        borderClass = 'border-purple-500';
                        bgClass = 'bg-purple-100 text-purple-600';
                        textClass = 'text-purple-600';
                        icon = 'ğŸ”µ';
                    } else if (spec.pipeType === 'æ¶²ç®¡') {
                        borderClass = 'border-pink-500';
                        bgClass = 'bg-pink-100 text-pink-600';
                        textClass = 'text-pink-600';
                        icon = 'ğŸŸ¢';
                    } else {
                        borderClass = 'border-orange-500';
                        bgClass = 'bg-orange-100 text-orange-600';
                        textClass = 'text-orange-600';
                        icon = 'ğŸŸ ';
                    }

                    return `
                    <div class="bg-white rounded-lg shadow-md p-5 border-l-4 ${borderClass} hover:shadow-xl transition-shadow">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ${bgClass}">
                                ${icon}
                            </div>
                            <div>
                                <div class="text-sm text-gray-500 font-medium">ç®¡è·¯ç±»å‹</div>
                                <div class="text-lg font-bold text-gray-800">${spec.pipeType}</div>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <div class="text-sm text-gray-500 font-medium mb-1">è§„æ ¼</div>
                            <div class="text-3xl font-extrabold ${textClass}">${spec.pipeSize}</div>
                        </div>
                    </div>
                `}).join('');

                // æ›´æ–°è®¾å¤‡ä¿¡æ¯å’Œå†·é‡ä¿¡æ¯
                const model = downstreamModels.find(m => m.id === modelId);
                const brand = brands.find(b => b.id === model.brandId);
                const deviceInfoEl3 = document.getElementById('deviceInfo3');
                const capacityInfoEl3 = document.getElementById('capacityInfo3');

                if (deviceInfoEl3 && capacityInfoEl3 && model && brand) {
                    deviceInfoEl3.textContent = `${brand.name}`;
                    capacityInfoEl3.textContent = `è®¾å¤‡å†·é‡ï¼š${model.modelName} kW`;
                }

                resultContainer3.classList.remove('hidden');
                noDataMessage3.classList.add('hidden');
            } else {
                resultContainer3.classList.add('hidden');
                noDataMessage3.classList.remove('hidden');
            }
        }

        // åˆå§‹åŒ–
        initBrandSelect();
        initBrandSelect2();
        initBrandSelect3();

        // ç”Ÿæˆå®¤å†…æœºè¾“å…¥æ¡†
        generateIndoorUnitInputs();

        // è°ƒè¯•ä¿¡æ¯
        console.log('=== åˆå§‹åŒ–è°ƒè¯•ä¿¡æ¯ ===');
        console.log('å“ç‰Œæ•°æ®é‡:', brands.length);
        console.log('å¤šè”æœºå†…æœºå‹å·æ•°æ®é‡:', models.length);
        console.log('å¤šè”æœºå†…æœºç®¡å¾„æ•°æ®é‡:', pipeSpecs.length);
        console.log('ä¸€æ‹–ä¸€å‹å·æ•°æ®é‡:', oneToOneModels.length);
        console.log('ä¸€æ‹–ä¸€ç®¡å¾„æ•°æ®é‡:', oneToOnePipeSpecs.length);
        console.log('å¤šè”æœºä¸‹æ¸¸ç®¡å¾„å‹å·æ•°æ®é‡:', downstreamModels.length);
        console.log('å¤šè”æœºä¸‹æ¸¸ç®¡å¾„è§„æ ¼æ•°æ®é‡:', downstreamPipeSpecs.length);
        console.log('brandSelecté€‰é¡¹æ•°:', brandSelect.options.length);
        console.log('brandSelect2é€‰é¡¹æ•°:', brandSelect2.options.length);
        console.log('brandSelect3é€‰é¡¹æ•°:', brandSelect3.options.length);
        console.log('localStorageç™»å½•çŠ¶æ€:', localStorage.getItem('isLoggedIn'));
        console.log('localStorageç®¡ç†å‘˜çŠ¶æ€:', localStorage.getItem('isAdmin'));

        // æœ€åè°ƒç”¨ updateUIï¼Œç¡®ä¿æ‰€æœ‰åˆå§‹åŒ–éƒ½å·²å®Œæˆ
        updateUI();
        }); // ç»“æŸ DOMContentLoaded
    </script>
</body>
</html>
